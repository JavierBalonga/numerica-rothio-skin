import{g as Xe,c as fe,a as Pe,r as A,u as Ze,j as N}from"./index-d4ce2077.js";var je={exports:{}};const Ye={},Ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),le=Xe(Ke);var Ue={exports:{}};const et=/^\u0001ACTION ([^\u0001]+)\u0001$/,tt=/^(justinfan)(\d+$)/,st=/\\([sn:r\\])/g,ot=/([ \n;\r\\])/g,pe={s:" ",n:"",":":";",r:""},ge={" ":"s","\n":"n",";":":","\r":"r"},rt=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),nt=/[|\\^$*+?:#]/,te=Ue.exports={get:(e,t)=>typeof e>"u"?t:e,hasOwn:(e,t)=>({}).hasOwnProperty.call(e,t),promiseDelay:e=>new Promise(t=>setTimeout(t,e)),isFinite:e=>isFinite(e)&&!isNaN(parseFloat(e)),toNumber(e,t){if(e===null)return 0;const s=Math.pow(10,te.isFinite(t)?t:0);return Math.round(e*s)/s},isInteger:e=>!isNaN(te.toNumber(e,0)),isRegex:e=>nt.test(e),isURL:e=>rt.test(e),justinfan:()=>`justinfan${Math.floor(Math.random()*8e4+1e3)}`,isJustinfan:e=>tt.test(e),channel(e){const t=(e||"").toLowerCase();return t[0]==="#"?t:"#"+t},username(e){const t=(e||"").toLowerCase();return t[0]==="#"?t.slice(1):t},token:e=>e?e.toLowerCase().replace("oauth:",""):"",password(e){const t=te.token(e);return t?`oauth:${t}`:""},actionMessage:e=>e.match(et),replaceAll(e,t){if(e===null||typeof e>"u")return null;for(const s in t)e=e.replace(new RegExp(s,"g"),t[s]);return e},unescapeHtml:e=>e.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'"),unescapeIRC(e){return!e||typeof e!="string"||!e.includes("\\")?e:e.replace(st,(t,s)=>s in pe?pe[s]:s)},escapeIRC(e){return!e||typeof e!="string"?e:e.replace(ot,(t,s)=>s in ge?`\\${ge[s]}`:s)},addWord:(e,t)=>e.length?e+" "+t:e+t,splitLine(e,t){let s=e.substring(0,t).lastIndexOf(" ");return s===-1&&(s=t-1),[e.substring(0,s),e.substring(s+1)]},extractNumber(e){const t=e.split(" ");for(let s=0;s<t.length;s++)if(te.isInteger(t[s]))return~~t[s];return 0},formatDate(e){let t=e.getHours(),s=e.getMinutes();return t=(t<10?"0":"")+t,s=(s<10?"0":"")+s,`${t}:${s}`},inherits(e,t){e.super_=t;const s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e},isNode(){try{return typeof process=="object"&&Object.prototype.toString.call(process)==="[object process]"}catch{}return!1}};var Y=Ue.exports;const it=le,be=Y;var at=function(t,s){let o=t.url!==void 0?t.url:t.uri;if(be.isURL(o)||(o=`https://api.twitch.tv/kraken${o[0]==="/"?o:`/${o}`}`),be.isNode()){const n=Object.assign({method:"GET",json:!0},t);if(n.qs){const f=new URLSearchParams(n.qs);o+=`?${f}`}const a={};"fetchAgent"in this.opts.connection&&(a.agent=this.opts.connection.fetchAgent);const u=it(o,{...a,method:n.method,headers:n.headers,body:n.body});let m={};u.then(f=>(m={statusCode:f.status,headers:f.headers},n.json?f.json():f.text())).then(f=>s(null,m,f),f=>s(f,m,null))}else{const n=Object.assign({method:"GET",headers:{}},t,{url:o}),a=new XMLHttpRequest;a.open(n.method,n.url,!0);for(const u in n.headers)a.setRequestHeader(u,n.headers[u]);a.responseType="json",a.addEventListener("load",u=>{a.readyState===4&&(a.status!==200?s(a.status,null,null):s(null,null,a.response))}),a.send()}};const y=Y;function _e(e,t){return e=y.channel(e),t=y.get(t,30),this._sendCommand(null,e,`/followers ${t}`,(s,o)=>{this.once("_promiseFollowers",n=>{n?o(n):s([e,~~t])})})}function ve(e){return e=y.channel(e),this._sendCommand(null,e,"/followersoff",(t,s)=>{this.once("_promiseFollowersoff",o=>{o?s(o):t([e])})})}function we(e){return e=y.channel(e),this._sendCommand(null,null,`PART ${e}`,(t,s)=>{this.once("_promisePart",o=>{o?s(o):t([e])})})}function ye(e){return e=y.channel(e),this._sendCommand(null,e,"/r9kbeta",(t,s)=>{this.once("_promiseR9kbeta",o=>{o?s(o):t([e])})})}function xe(e){return e=y.channel(e),this._sendCommand(null,e,"/r9kbetaoff",(t,s)=>{this.once("_promiseR9kbetaoff",o=>{o?s(o):t([e])})})}function Ce(e,t){return e=y.channel(e),t=y.get(t,300),this._sendCommand(null,e,`/slow ${t}`,(s,o)=>{this.once("_promiseSlow",n=>{n?o(n):s([e,~~t])})})}function ke(e){return e=y.channel(e),this._sendCommand(null,e,"/slowoff",(t,s)=>{this.once("_promiseSlowoff",o=>{o?s(o):t([e])})})}var lt={action(e,t){return e=y.channel(e),t=`ACTION ${t}`,this._sendMessage(this._getPromiseDelay(),e,t,(s,o)=>{s([e,t])})},ban(e,t,s){return e=y.channel(e),t=y.username(t),s=y.get(s,""),this._sendCommand(null,e,`/ban ${t} ${s}`,(o,n)=>{this.once("_promiseBan",a=>{a?n(a):o([e,t,s])})})},clear(e){return e=y.channel(e),this._sendCommand(null,e,"/clear",(t,s)=>{this.once("_promiseClear",o=>{o?s(o):t([e])})})},color(e,t){return t=y.get(t,e),this._sendCommand(null,"#tmijs",`/color ${t}`,(s,o)=>{this.once("_promiseColor",n=>{n?o(n):s([t])})})},commercial(e,t){return e=y.channel(e),t=y.get(t,30),this._sendCommand(null,e,`/commercial ${t}`,(s,o)=>{this.once("_promiseCommercial",n=>{n?o(n):s([e,~~t])})})},deletemessage(e,t){return e=y.channel(e),this._sendCommand(null,e,`/delete ${t}`,(s,o)=>{this.once("_promiseDeletemessage",n=>{n?o(n):s([e])})})},emoteonly(e){return e=y.channel(e),this._sendCommand(null,e,"/emoteonly",(t,s)=>{this.once("_promiseEmoteonly",o=>{o?s(o):t([e])})})},emoteonlyoff(e){return e=y.channel(e),this._sendCommand(null,e,"/emoteonlyoff",(t,s)=>{this.once("_promiseEmoteonlyoff",o=>{o?s(o):t([e])})})},followersonly:_e,followersmode:_e,followersonlyoff:ve,followersmodeoff:ve,host(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(2e3,e,`/host ${t}`,(s,o)=>{this.once("_promiseHost",(n,a)=>{n?o(n):s([e,t,~~a])})})},join(e){return e=y.channel(e),this._sendCommand(void 0,null,`JOIN ${e}`,(t,s)=>{const o="_promiseJoin";let n=!1;const a=(m,f)=>{e===y.channel(f)&&(this.removeListener(o,a),n=!0,m?s(m):t([e]))};this.on(o,a);const u=this._getPromiseDelay();y.promiseDelay(u).then(()=>{n||this.emit(o,"No response from Twitch.",e)})})},mod(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/mod ${t}`,(s,o)=>{this.once("_promiseMod",n=>{n?o(n):s([e,t])})})},mods(e){return e=y.channel(e),this._sendCommand(null,e,"/mods",(t,s)=>{this.once("_promiseMods",(o,n)=>{o?s(o):(n.forEach(a=>{this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].includes(a)||this.moderators[e].push(a)}),t(n))})})},part:we,leave:we,ping(){return this._sendCommand(null,null,"PING",(e,t)=>{this.latency=new Date,this.pingTimeout=setTimeout(()=>{this.ws!==null&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout))},y.get(this.opts.connection.timeout,9999)),this.once("_promisePing",s=>e([parseFloat(s)]))})},r9kbeta:ye,r9kmode:ye,r9kbetaoff:xe,r9kmodeoff:xe,raw(e){return this._sendCommand(null,null,e,(t,s)=>{t([e])})},say(e,t){return e=y.channel(e),t.startsWith(".")&&!t.startsWith("..")||t.startsWith("/")||t.startsWith("\\")?t.substr(1,3)==="me "?this.action(e,t.substr(4)):this._sendCommand(null,e,t,(s,o)=>{s([e,t])}):this._sendMessage(this._getPromiseDelay(),e,t,(s,o)=>{s([e,t])})},slow:Ce,slowmode:Ce,slowoff:ke,slowmodeoff:ke,subscribers(e){return e=y.channel(e),this._sendCommand(null,e,"/subscribers",(t,s)=>{this.once("_promiseSubscribers",o=>{o?s(o):t([e])})})},subscribersoff(e){return e=y.channel(e),this._sendCommand(null,e,"/subscribersoff",(t,s)=>{this.once("_promiseSubscribersoff",o=>{o?s(o):t([e])})})},timeout(e,t,s,o){return e=y.channel(e),t=y.username(t),s!==null&&!y.isInteger(s)&&(o=s,s=300),s=y.get(s,300),o=y.get(o,""),this._sendCommand(null,e,`/timeout ${t} ${s} ${o}`,(n,a)=>{this.once("_promiseTimeout",u=>{u?a(u):n([e,t,~~s,o])})})},unban(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/unban ${t}`,(s,o)=>{this.once("_promiseUnban",n=>{n?o(n):s([e,t])})})},unhost(e){return e=y.channel(e),this._sendCommand(2e3,e,"/unhost",(t,s)=>{this.once("_promiseUnhost",o=>{o?s(o):t([e])})})},unmod(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/unmod ${t}`,(s,o)=>{this.once("_promiseUnmod",n=>{n?o(n):s([e,t])})})},unvip(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/unvip ${t}`,(s,o)=>{this.once("_promiseUnvip",n=>{n?o(n):s([e,t])})})},vip(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/vip ${t}`,(s,o)=>{this.once("_promiseVip",n=>{n?o(n):s([e,t])})})},vips(e){return e=y.channel(e),this._sendCommand(null,e,"/vips",(t,s)=>{this.once("_promiseVips",(o,n)=>{o?s(o):t(n)})})},whisper(e,t){return e=y.username(e),e===this.getUsername()?Promise.reject("Cannot send a whisper to the same account."):this._sendCommand(null,"#tmijs",`/w ${e} ${t}`,(s,o)=>{this.once("_promiseWhisper",n=>{n&&o(n)})}).catch(s=>{if(s&&typeof s=="string"&&s.indexOf("No response from Twitch.")!==0)throw s;const o=y.channel(e),n=Object.assign({"message-type":"whisper","message-id":null,"thread-id":null,username:this.getUsername()},this.globaluserstate);return this.emits(["whisper","message"],[[o,n,t,!0],[o,n,t,!0]]),[e,t]})}};function M(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var ct=M;M.EventEmitter=M;M.prototype._events=void 0;M.prototype._maxListeners=void 0;M.defaultMaxListeners=10;M.prototype.setMaxListeners=function(e){if(!ut(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this};M.prototype.emit=function(e){var t,s,o,n,a,u;if(this._events||(this._events={}),e==="error"&&(!this._events.error||X(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(s=this._events[e],Ge(s))return!1;if(j(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),s.apply(this,n)}else if(X(s))for(n=Array.prototype.slice.call(arguments,1),u=s.slice(),o=u.length,a=0;a<o;a++)u[a].apply(this,n);return!0};M.prototype.addListener=function(e,t){var s;if(!j(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,j(t.listener)?t.listener:t),this._events[e]?X(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,X(this._events[e])&&!this._events[e].warned&&(Ge(this._maxListeners)?s=M.defaultMaxListeners:s=this._maxListeners,s&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),typeof console.trace=="function"&&console.trace())),this};M.prototype.on=M.prototype.addListener;M.prototype.once=function(e,t){if(!j(t))throw TypeError("listener must be a function");var s=!1;if(this._events.hasOwnProperty(e)&&e.charAt(0)==="_"){var o=1,n=e;for(var a in this._events)this._events.hasOwnProperty(a)&&a.startsWith(n)&&o++;e=e+o}function u(){e.charAt(0)==="_"&&!isNaN(e.substr(e.length-1))&&(e=e.substring(0,e.length-1)),this.removeListener(e,u),s||(s=!0,t.apply(this,arguments))}return u.listener=t,this.on(e,u),this};M.prototype.removeListener=function(e,t){var s,o,n,a;if(!j(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=this._events[e],n=s.length,o=-1,s===t||j(s.listener)&&s.listener===t){if(delete this._events[e],this._events.hasOwnProperty(e+"2")&&e.charAt(0)==="_"){var u=e;for(var m in this._events)this._events.hasOwnProperty(m)&&m.startsWith(u)&&(isNaN(parseInt(m.substr(m.length-1)))||(this._events[e+parseInt(m.substr(m.length-1)-1)]=this._events[m],delete this._events[m]));this._events[e]=this._events[e+"1"],delete this._events[e+"1"]}this._events.removeListener&&this.emit("removeListener",e,t)}else if(X(s)){for(a=n;a-- >0;)if(s[a]===t||s[a].listener&&s[a].listener===t){o=a;break}if(o<0)return this;s.length===1?(s.length=0,delete this._events[e]):s.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this};M.prototype.removeAllListeners=function(e){var t,s;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[e]&&delete this._events[e],this;if(arguments.length===0){for(t in this._events)t!=="removeListener"&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[e],j(s))this.removeListener(e,s);else if(s)for(;s.length;)this.removeListener(e,s[s.length-1]);return delete this._events[e],this};M.prototype.listeners=function(e){var t;return!this._events||!this._events[e]?t=[]:j(this._events[e])?t=[this._events[e]]:t=this._events[e].slice(),t};M.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(j(t))return 1;if(t)return t.length}return 0};M.listenerCount=function(e,t){return e.listenerCount(t)};function j(e){return typeof e=="function"}function ut(e){return typeof e=="number"}function X(e){return typeof e=="object"&&e!==null}function Ge(e){return e===void 0}const dt=Y;let De="info";const Se={trace:0,debug:1,info:2,warn:3,error:4,fatal:5};function F(e){return function(t){Se[e]>=Se[De]&&console.log(`[${dt.formatDate(new Date)}] ${e}: ${t}`)}}var ht={setLevel(e){De=e},trace:F("trace"),debug:F("debug"),info:F("info"),warn:F("warn"),error:F("error"),fatal:F("fatal")};const ne=Y,W=/\S+/g;function ie(e,t,s=",",o="/",n){const a=e[t];if(a===void 0)return e;const u=typeof a=="string";if(e[t+"-raw"]=u?a:null,a===!0)return e[t]=null,e;if(e[t]={},u){const m=a.split(s);for(let f=0;f<m.length;f++){const v=m[f].split(o);let d=v[1];n!==void 0&&d&&(d=d.split(n)),e[t][v[0]]=d||null}}return e}var mt={badges:e=>ie(e,"badges"),badgeInfo:e=>ie(e,"badge-info"),emotes:e=>ie(e,"emotes","/",":",","),emoteRegex(e,t,s,o){W.lastIndex=0;const n=new RegExp("(\\b|^|\\s)"+ne.unescapeHtml(t)+"(\\b|$|\\s)");let a;for(;(a=W.exec(e))!==null;)n.test(a[0])&&(o[s]=o[s]||[],o[s].push([a.index,W.lastIndex-1]))},emoteString(e,t,s,o){W.lastIndex=0;let n;for(;(n=W.exec(e))!==null;)n[0]===ne.unescapeHtml(t)&&(o[s]=o[s]||[],o[s].push([n.index,W.lastIndex-1]))},transformEmotes(e){let t="";return Object.keys(e).forEach(s=>{t=`${t+s}:`,e[s].forEach(o=>t=`${t+o.join("-")},`),t=`${t.slice(0,-1)}/`}),t.slice(0,-1)},formTags(e){const t=[];for(const s in e){const o=ne.escapeIRC(e[s]);t.push(`${s}=${o}`)}return`@${t.join(";")}`},msg(e){const t={raw:e,tags:{},prefix:null,command:null,params:[]};let s=0,o=0;if(e.charCodeAt(0)===64){if(o=e.indexOf(" "),o===-1)return null;const n=e.slice(1,o).split(";");for(let a=0;a<n.length;a++){const u=n[a],m=u.split("=");t.tags[m[0]]=u.substring(u.indexOf("=")+1)||!0}s=o+1}for(;e.charCodeAt(s)===32;)s++;if(e.charCodeAt(s)===58){if(o=e.indexOf(" ",s),o===-1)return null;for(t.prefix=e.slice(s+1,o),s=o+1;e.charCodeAt(s)===32;)s++}if(o=e.indexOf(" ",s),o===-1)return e.length>s?(t.command=e.slice(s),t):null;for(t.command=e.slice(s,o),s=o+1;e.charCodeAt(s)===32;)s++;for(;s<e.length;){if(o=e.indexOf(" ",s),e.charCodeAt(s)===58){t.params.push(e.slice(s+1));break}if(o!==-1){for(t.params.push(e.slice(s,o)),s=o+1;e.charCodeAt(s)===32;)s++;continue}if(o===-1){t.params.push(e.slice(s));break}}return t}};class ft{constructor(t){this.queue=[],this.index=0,this.defaultDelay=t===void 0?3e3:t}add(t,s){this.queue.push({fn:t,delay:s})}next(){const t=this.index++,s=this.queue[t];if(!s)return;const o=this.queue[this.index];if(s.fn(),o){const n=o.delay===void 0?this.defaultDelay:o.delay;setTimeout(()=>this.next(),n)}}}var pt=ft;(function(e){const t=typeof fe<"u"?fe:typeof window<"u"?window:{},s=t.WebSocket||le,o=t.fetch||le,n=at,a=lt,u=ct.EventEmitter,m=ht,f=mt,v=pt,d=Y;let x=!1;const _=function p(i){if(!(this instanceof p))return new p(i);this.opts=d.get(i,{}),this.opts.channels=this.opts.channels||[],this.opts.connection=this.opts.connection||{},this.opts.identity=this.opts.identity||{},this.opts.options=this.opts.options||{},this.clientId=d.get(this.opts.options.clientId,null),this._globalDefaultChannel=d.channel(d.get(this.opts.options.globalDefaultChannel,"#tmijs")),this._skipMembership=d.get(this.opts.options.skipMembership,!1),this._skipUpdatingEmotesets=d.get(this.opts.options.skipUpdatingEmotesets,!1),this._updateEmotesetsTimer=null,this._updateEmotesetsTimerDelay=d.get(this.opts.options.updateEmotesetsTimer,6e4),this.maxReconnectAttempts=d.get(this.opts.connection.maxReconnectAttempts,1/0),this.maxReconnectInterval=d.get(this.opts.connection.maxReconnectInterval,3e4),this.reconnect=d.get(this.opts.connection.reconnect,!0),this.reconnectDecay=d.get(this.opts.connection.reconnectDecay,1.5),this.reconnectInterval=d.get(this.opts.connection.reconnectInterval,1e3),this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.secure=d.get(this.opts.connection.secure,!this.opts.connection.server&&!this.opts.connection.port),this.emotes="",this.emotesets={},this.channels=[],this.currentLatency=0,this.globaluserstate={},this.lastJoined="",this.latency=new Date,this.moderators={},this.pingLoop=null,this.pingTimeout=null,this.reason="",this.username="",this.userstate={},this.wasCloseCalled=!1,this.ws=null;let r="error";this.opts.options.debug&&(r="info"),this.log=this.opts.logger||m;try{m.setLevel(r)}catch{}this.opts.channels.forEach((l,g,h)=>h[g]=d.channel(l)),u.call(this),this.setMaxListeners(0)};d.inherits(_,u);for(const p in a)_.prototype[p]=a[p];_.prototype.emits=function(i,r){for(let l=0;l<i.length;l++){const g=l<r.length?r[l]:r[r.length-1];this.emit.apply(this,[i[l]].concat(g))}},_.prototype.api=function(...p){x||(this.log.warn("Client.prototype.api is deprecated and will be removed for version 2.0.0"),x=!0),n(...p)},_.prototype.handleMessage=function(i){if(!i)return;this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(i)),i);const r=d.channel(d.get(i.params[0],null));let l=d.get(i.params[1],null);const g=d.get(i.tags["msg-id"],null),h=i.tags=f.badges(f.badgeInfo(f.emotes(i.tags)));for(const c in h){if(c==="emote-sets"||c==="ban-duration"||c==="bits")continue;let b=h[c];typeof b=="boolean"?b=null:b==="1"?b=!0:b==="0"?b=!1:typeof b=="string"&&(b=d.unescapeIRC(b)),h[c]=b}if(i.prefix===null)switch(i.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":{const c=new Date;this.currentLatency=(c.getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break}default:this.log.warn(`Could not parse message with no prefix:
${JSON.stringify(i,null,4)}`);break}else if(i.prefix==="tmi.twitch.tv")switch(i.command){case"002":case"003":case"004":case"372":case"375":case"CAP":break;case"001":this.username=i.params[0];break;case"376":{this.log.info("Connected to server."),this.userstate[this._globalDefaultChannel]={},this.emits(["connected","_promiseConnect"],[[this.server,this.port],[null]]),this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.pingLoop=setInterval(()=>{this._isConnected()&&this.ws.send("PING"),this.latency=new Date,this.pingTimeout=setTimeout(()=>{this.ws!==null&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer))},d.get(this.opts.connection.timeout,9999))},6e4);let c=d.get(this.opts.options.joinInterval,2e3);c<300&&(c=300);const b=new v(c),S=[...new Set([...this.opts.channels,...this.channels])];this.channels=[];for(let I=0;I<S.length;I++){const T=S[I];b.add(()=>{this._isConnected()&&this.join(T).catch(C=>this.log.error(C))})}b.next();break}case"NOTICE":{const c=[null],b=[r,g,l],S=[g],I=[r,!0],T=[r,!1],C=[b,c],k=[b,S],w=`[${r}] ${l}`;switch(g){case"subs_on":this.log.info(`[${r}] This room is now in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribers"],[I,I,c]);break;case"subs_off":this.log.info(`[${r}] This room is no longer in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribersoff"],[T,T,c]);break;case"emote_only_on":this.log.info(`[${r}] This room is now in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonly"],[I,c]);break;case"emote_only_off":this.log.info(`[${r}] This room is no longer in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonlyoff"],[T,c]);break;case"slow_on":case"slow_off":break;case"followers_on_zero":case"followers_on":case"followers_off":break;case"r9k_on":this.log.info(`[${r}] This room is now in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbeta"],[I,I,c]);break;case"r9k_off":this.log.info(`[${r}] This room is no longer in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbetaoff"],[T,T,c]);break;case"room_mods":{const R=l.split(": "),P=(R.length>1?R[1]:"").toLowerCase().split(", ").filter(U=>U);this.emits(["_promiseMods","mods"],[[null,P],[r,P]]);break}case"no_mods":this.emits(["_promiseMods","mods"],[[null,[]],[r,[]]]);break;case"vips_success":{l.endsWith(".")&&(l=l.slice(0,-1));const R=l.split(": "),P=(R.length>1?R[1]:"").toLowerCase().split(", ").filter(U=>U);this.emits(["_promiseVips","vips"],[[null,P],[r,P]]);break}case"no_vips":this.emits(["_promiseVips","vips"],[[null,[]],[r,[]]]);break;case"already_banned":case"bad_ban_admin":case"bad_ban_anon":case"bad_ban_broadcaster":case"bad_ban_global_mod":case"bad_ban_mod":case"bad_ban_self":case"bad_ban_staff":case"usage_ban":this.log.info(w),this.emits(["notice","_promiseBan"],k);break;case"ban_success":this.log.info(w),this.emits(["notice","_promiseBan"],C);break;case"usage_clear":this.log.info(w),this.emits(["notice","_promiseClear"],k);break;case"usage_mods":this.log.info(w),this.emits(["notice","_promiseMods"],[b,[g,[]]]);break;case"mod_success":this.log.info(w),this.emits(["notice","_promiseMod"],C);break;case"usage_vips":this.log.info(w),this.emits(["notice","_promiseVips"],[b,[g,[]]]);break;case"usage_vip":case"bad_vip_grantee_banned":case"bad_vip_grantee_already_vip":case"bad_vip_max_vips_reached":case"bad_vip_achievement_incomplete":this.log.info(w),this.emits(["notice","_promiseVip"],[b,[g,[]]]);break;case"vip_success":this.log.info(w),this.emits(["notice","_promiseVip"],C);break;case"usage_mod":case"bad_mod_banned":case"bad_mod_mod":this.log.info(w),this.emits(["notice","_promiseMod"],k);break;case"unmod_success":this.log.info(w),this.emits(["notice","_promiseUnmod"],C);break;case"unvip_success":this.log.info(w),this.emits(["notice","_promiseUnvip"],C);break;case"usage_unmod":case"bad_unmod_mod":this.log.info(w),this.emits(["notice","_promiseUnmod"],k);break;case"usage_unvip":case"bad_unvip_grantee_not_vip":this.log.info(w),this.emits(["notice","_promiseUnvip"],k);break;case"color_changed":this.log.info(w),this.emits(["notice","_promiseColor"],C);break;case"usage_color":case"turbo_only_color":this.log.info(w),this.emits(["notice","_promiseColor"],k);break;case"commercial_success":this.log.info(w),this.emits(["notice","_promiseCommercial"],C);break;case"usage_commercial":case"bad_commercial_error":this.log.info(w),this.emits(["notice","_promiseCommercial"],k);break;case"hosts_remaining":{this.log.info(w);const R=isNaN(l[0])?0:parseInt(l[0]);this.emits(["notice","_promiseHost"],[b,[null,~~R]]);break}case"bad_host_hosting":case"bad_host_rate_exceeded":case"bad_host_error":case"usage_host":this.log.info(w),this.emits(["notice","_promiseHost"],[b,[g,null]]);break;case"already_r9k_on":case"usage_r9k_on":this.log.info(w),this.emits(["notice","_promiseR9kbeta"],k);break;case"already_r9k_off":case"usage_r9k_off":this.log.info(w),this.emits(["notice","_promiseR9kbetaoff"],k);break;case"timeout_success":this.log.info(w),this.emits(["notice","_promiseTimeout"],C);break;case"delete_message_success":this.log.info(`[${r} ${l}]`),this.emits(["notice","_promiseDeletemessage"],C);break;case"already_subs_off":case"usage_subs_off":this.log.info(w),this.emits(["notice","_promiseSubscribersoff"],k);break;case"already_subs_on":case"usage_subs_on":this.log.info(w),this.emits(["notice","_promiseSubscribers"],k);break;case"already_emote_only_off":case"usage_emote_only_off":this.log.info(w),this.emits(["notice","_promiseEmoteonlyoff"],k);break;case"already_emote_only_on":case"usage_emote_only_on":this.log.info(w),this.emits(["notice","_promiseEmoteonly"],k);break;case"usage_slow_on":this.log.info(w),this.emits(["notice","_promiseSlow"],k);break;case"usage_slow_off":this.log.info(w),this.emits(["notice","_promiseSlowoff"],k);break;case"usage_timeout":case"bad_timeout_admin":case"bad_timeout_anon":case"bad_timeout_broadcaster":case"bad_timeout_duration":case"bad_timeout_global_mod":case"bad_timeout_mod":case"bad_timeout_self":case"bad_timeout_staff":this.log.info(w),this.emits(["notice","_promiseTimeout"],k);break;case"untimeout_success":case"unban_success":this.log.info(w),this.emits(["notice","_promiseUnban"],C);break;case"usage_unban":case"bad_unban_no_ban":this.log.info(w),this.emits(["notice","_promiseUnban"],k);break;case"usage_delete":case"bad_delete_message_error":case"bad_delete_message_broadcaster":case"bad_delete_message_mod":this.log.info(w),this.emits(["notice","_promiseDeletemessage"],k);break;case"usage_unhost":case"not_hosting":this.log.info(w),this.emits(["notice","_promiseUnhost"],k);break;case"whisper_invalid_login":case"whisper_invalid_self":case"whisper_limit_per_min":case"whisper_limit_per_sec":case"whisper_restricted":case"whisper_restricted_recipient":this.log.info(w),this.emits(["notice","_promiseWhisper"],k);break;case"no_permission":case"msg_banned":case"msg_room_not_found":case"msg_channel_suspended":case"tos_ban":case"invalid_user":this.log.info(w),this.emits(["notice","_promiseBan","_promiseClear","_promiseUnban","_promiseTimeout","_promiseDeletemessage","_promiseMods","_promiseMod","_promiseUnmod","_promiseVips","_promiseVip","_promiseUnvip","_promiseCommercial","_promiseHost","_promiseUnhost","_promiseJoin","_promisePart","_promiseR9kbeta","_promiseR9kbetaoff","_promiseSlow","_promiseSlowoff","_promiseFollowers","_promiseFollowersoff","_promiseSubscribers","_promiseSubscribersoff","_promiseEmoteonly","_promiseEmoteonlyoff","_promiseWhisper"],[b,[g,r]]);break;case"msg_rejected":case"msg_rejected_mandatory":this.log.info(w),this.emit("automod",r,g,l);break;case"unrecognized_cmd":this.log.info(w),this.emit("notice",r,g,l);break;case"cmds_available":case"host_target_went_offline":case"msg_censored_broadcaster":case"msg_duplicate":case"msg_emoteonly":case"msg_verified_email":case"msg_ratelimit":case"msg_subsonly":case"msg_timedout":case"msg_bad_characters":case"msg_channel_blocked":case"msg_facebook":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_slowmode":case"msg_suspended":case"no_help":case"usage_disconnect":case"usage_help":case"usage_me":case"unavailable_command":this.log.info(w),this.emit("notice",r,g,l);break;case"host_on":case"host_off":break;default:l.includes("Login unsuccessful")||l.includes("Login authentication failed")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=l,this.log.error(this.reason),this.ws.close()):l.includes("Error logging in")||l.includes("Improperly formatted auth")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=l,this.log.error(this.reason),this.ws.close()):l.includes("Invalid NICK")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason="Invalid NICK.",this.log.error(this.reason),this.ws.close()):(this.log.warn(`Could not parse NOTICE from tmi.twitch.tv:
${JSON.stringify(i,null,4)}`),this.emit("notice",r,g,l));break}break}case"USERNOTICE":{const c=h["display-name"]||h.login,b=h["msg-param-sub-plan"]||"",S=d.unescapeIRC(d.get(h["msg-param-sub-plan-name"],""))||null,T={prime:b.includes("Prime"),plan:b,planName:S},C=~~(h["msg-param-streak-months"]||0),k=h["msg-param-recipient-display-name"]||h["msg-param-recipient-user-name"],w=~~h["msg-param-mass-gift-count"];switch(h["message-type"]=g,g){case"resub":this.emits(["resub","subanniversary"],[[r,c,C,l,h,T]]);break;case"sub":this.emits(["subscription","sub"],[[r,c,T,l,h]]);break;case"subgift":this.emit("subgift",r,c,C,k,T,h);break;case"anonsubgift":this.emit("anonsubgift",r,C,k,T,h);break;case"submysterygift":this.emit("submysterygift",r,c,w,T,h);break;case"anonsubmysterygift":this.emit("anonsubmysterygift",r,w,T,h);break;case"primepaidupgrade":this.emit("primepaidupgrade",r,c,T,h);break;case"giftpaidupgrade":{const R=h["msg-param-sender-name"]||h["msg-param-sender-login"];this.emit("giftpaidupgrade",r,c,R,h);break}case"anongiftpaidupgrade":this.emit("anongiftpaidupgrade",r,c,h);break;case"raid":{const R=h["msg-param-displayName"]||h["msg-param-login"],P=+h["msg-param-viewerCount"];this.emit("raided",r,R,P,h);break}case"ritual":{const R=h["msg-param-ritual-name"];switch(R){case"new_chatter":this.emit("newchatter",r,c,h,l);break;default:this.emit("ritual",R,r,c,h,l);break}break}default:this.emit("usernotice",g,r,h,l);break}break}case"HOSTTARGET":{const c=l.split(" "),b=~~c[1]||0;c[0]==="-"?(this.log.info(`[${r}] Exited host mode.`),this.emits(["unhost","_promiseUnhost"],[[r,b],[null]])):(this.log.info(`[${r}] Now hosting ${c[0]} for ${b} viewer(s).`),this.emit("hosting",r,c[0],b));break}case"CLEARCHAT":if(i.params.length>1){const c=d.get(i.tags["ban-duration"],null);c===null?(this.log.info(`[${r}] ${l} has been banned.`),this.emit("ban",r,l,null,i.tags)):(this.log.info(`[${r}] ${l} has been timed out for ${c} seconds.`),this.emit("timeout",r,l,null,~~c,i.tags))}else this.log.info(`[${r}] Chat was cleared by a moderator.`),this.emits(["clearchat","_promiseClear"],[[r],[null]]);break;case"CLEARMSG":if(i.params.length>1){const c=l,b=h.login;h["message-type"]="messagedeleted",this.log.info(`[${r}] ${b}'s message has been deleted.`),this.emit("messagedeleted",r,b,c,h)}break;case"RECONNECT":this.log.info("Received RECONNECT request from Twitch.."),this.log.info(`Disconnecting and reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.disconnect().catch(c=>this.log.error(c)),setTimeout(()=>this.connect().catch(c=>this.log.error(c)),this.reconnectTimer);break;case"USERSTATE":i.tags.username=this.username,i.tags["user-type"]==="mod"&&(this.moderators[r]||(this.moderators[r]=[]),this.moderators[r].includes(this.username)||this.moderators[r].push(this.username)),!d.isJustinfan(this.getUsername())&&!this.userstate[r]&&(this.userstate[r]=h,this.lastJoined=r,this.channels.push(r),this.log.info(`Joined ${r}`),this.emit("join",r,d.username(this.getUsername()),!0)),i.tags["emote-sets"]!==this.emotes&&this._updateEmoteset(i.tags["emote-sets"]),this.userstate[r]=h;break;case"GLOBALUSERSTATE":this.globaluserstate=h,this.emit("globaluserstate",h),typeof i.tags["emote-sets"]<"u"&&this._updateEmoteset(i.tags["emote-sets"]);break;case"ROOMSTATE":if(d.channel(this.lastJoined)===r&&this.emit("_promiseJoin",null,r),i.tags.channel=r,this.emit("roomstate",r,i.tags),!d.hasOwn(i.tags,"subs-only")){if(d.hasOwn(i.tags,"slow"))if(typeof i.tags.slow=="boolean"&&!i.tags.slow){const c=[r,!1,0];this.log.info(`[${r}] This room is no longer in slow mode.`),this.emits(["slow","slowmode","_promiseSlowoff"],[c,c,[null]])}else{const c=~~i.tags.slow,b=[r,!0,c];this.log.info(`[${r}] This room is now in slow mode.`),this.emits(["slow","slowmode","_promiseSlow"],[b,b,[null]])}if(d.hasOwn(i.tags,"followers-only"))if(i.tags["followers-only"]==="-1"){const c=[r,!1,0];this.log.info(`[${r}] This room is no longer in followers-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowersoff"],[c,c,[null]])}else{const c=~~i.tags["followers-only"],b=[r,!0,c];this.log.info(`[${r}] This room is now in follower-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowers"],[b,b,[null]])}}break;case"SERVERCHANGE":break;default:this.log.warn(`Could not parse message from tmi.twitch.tv:
${JSON.stringify(i,null,4)}`);break}else if(i.prefix==="jtv")switch(i.command){case"MODE":l==="+o"?(this.moderators[r]||(this.moderators[r]=[]),this.moderators[r].includes(i.params[2])||this.moderators[r].push(i.params[2]),this.emit("mod",r,i.params[2])):l==="-o"&&(this.moderators[r]||(this.moderators[r]=[]),this.moderators[r].filter(c=>c!==i.params[2]),this.emit("unmod",r,i.params[2]));break;default:this.log.warn(`Could not parse message from jtv:
${JSON.stringify(i,null,4)}`);break}else switch(i.command){case"353":this.emit("names",i.params[2],i.params[3].split(" "));break;case"366":break;case"JOIN":{const c=i.prefix.split("!")[0];d.isJustinfan(this.getUsername())&&this.username===c&&(this.lastJoined=r,this.channels.push(r),this.log.info(`Joined ${r}`),this.emit("join",r,c,!0)),this.username!==c&&this.emit("join",r,c,!1);break}case"PART":{let c=!1;const b=i.prefix.split("!")[0];if(this.username===b){c=!0,this.userstate[r]&&delete this.userstate[r];let S=this.channels.indexOf(r);S!==-1&&this.channels.splice(S,1),S=this.opts.channels.indexOf(r),S!==-1&&this.opts.channels.splice(S,1),this.log.info(`Left ${r}`),this.emit("_promisePart",null)}this.emit("part",r,b,c);break}case"WHISPER":{const c=i.prefix.split("!")[0];this.log.info(`[WHISPER] <${c}>: ${l}`),d.hasOwn(i.tags,"username")||(i.tags.username=c),i.tags["message-type"]="whisper";const b=d.channel(i.tags.username);this.emits(["whisper","message"],[[b,i.tags,l,!1]]);break}case"PRIVMSG":if(i.tags.username=i.prefix.split("!")[0],i.tags.username==="jtv"){const c=d.username(l.split(" ")[0]),b=l.includes("auto");if(l.includes("hosting you for")){const S=d.extractNumber(l);this.emit("hosted",r,c,S,b)}else l.includes("hosting you")&&this.emit("hosted",r,c,0,b)}else{const c=d.get(this.opts.options.messagesLogLevel,"info"),b=d.actionMessage(l);if(i.tags["message-type"]=b?"action":"chat",l=b?b[1]:l,d.hasOwn(i.tags,"bits"))this.emit("cheer",r,i.tags,l);else{if(d.hasOwn(i.tags,"msg-id")){if(i.tags["msg-id"]==="highlighted-message"){const S=i.tags["msg-id"];this.emit("redeem",r,i.tags.username,S,i.tags,l)}else if(i.tags["msg-id"]==="skip-subs-mode-message"){const S=i.tags["msg-id"];this.emit("redeem",r,i.tags.username,S,i.tags,l)}}else if(d.hasOwn(i.tags,"custom-reward-id")){const S=i.tags["custom-reward-id"];this.emit("redeem",r,i.tags.username,S,i.tags,l)}b?(this.log[c](`[${r}] *<${i.tags.username}>: ${l}`),this.emits(["action","message"],[[r,i.tags,l,!1]])):(this.log[c](`[${r}] <${i.tags.username}>: ${l}`),this.emits(["chat","message"],[[r,i.tags,l,!1]]))}}break;default:this.log.warn(`Could not parse message:
${JSON.stringify(i,null,4)}`);break}},_.prototype.connect=function(){return new Promise((i,r)=>{this.server=d.get(this.opts.connection.server,"irc-ws.chat.twitch.tv"),this.port=d.get(this.opts.connection.port,80),this.secure&&(this.port=443),this.port===443&&(this.secure=!0),this.reconnectTimer=this.reconnectTimer*this.reconnectDecay,this.reconnectTimer>=this.maxReconnectInterval&&(this.reconnectTimer=this.maxReconnectInterval),this._openConnection(),this.once("_promiseConnect",l=>{l?r(l):i([this.server,~~this.port])})})},_.prototype._openConnection=function(){const i=`${this.secure?"wss":"ws"}://${this.server}:${this.port}/`,r={};"agent"in this.opts.connection&&(r.agent=this.opts.connection.agent),this.ws=new s(i,"irc",r),this.ws.onmessage=this._onMessage.bind(this),this.ws.onerror=this._onError.bind(this),this.ws.onclose=this._onClose.bind(this),this.ws.onopen=this._onOpen.bind(this)},_.prototype._onOpen=function(){this._isConnected()&&(this.log.info(`Connecting to ${this.server} on port ${this.port}..`),this.emit("connecting",this.server,~~this.port),this.username=d.get(this.opts.identity.username,d.justinfan()),this._getToken().then(i=>{const r=d.password(i);this.log.info("Sending authentication to server.."),this.emit("logon");let l="twitch.tv/tags twitch.tv/commands";this._skipMembership||(l+=" twitch.tv/membership"),this.ws.send("CAP REQ :"+l),r?this.ws.send(`PASS ${r}`):d.isJustinfan(this.username)&&this.ws.send("PASS SCHMOOPIIE"),this.ws.send(`NICK ${this.username}`)}).catch(i=>{this.emits(["_promiseConnect","disconnected"],[[i],["Could not get a token."]])}))},_.prototype._getToken=function(){const i=this.opts.identity.password;let r;return typeof i=="function"?(r=i(),r instanceof Promise?r:Promise.resolve(r)):Promise.resolve(i)},_.prototype._onMessage=function(i){i.data.trim().split(`\r
`).forEach(l=>{const g=f.msg(l);g&&this.handleMessage(g)})},_.prototype._onError=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.reason=this.ws===null?"Connection closed.":"Unable to connect.",this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout(()=>{this.reconnecting=!1,this.connect().catch(i=>this.log.error(i))},this.reconnectTimer)),this.ws=null},_.prototype._onClose=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.wasCloseCalled?(this.wasCloseCalled=!1,this.reason="Connection closed.",this.log.info(this.reason),this.emits(["_promiseConnect","_promiseDisconnect","disconnected"],[[this.reason],[null],[this.reason]])):(this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Could not connect to server. Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout(()=>{this.reconnecting=!1,this.connect().catch(i=>this.log.error(i))},this.reconnectTimer))),this.ws=null},_.prototype._getPromiseDelay=function(){return this.currentLatency<=600?600:this.currentLatency+100},_.prototype._sendCommand=function(i,r,l,g){return new Promise((h,c)=>{if(this._isConnected())(i===null||typeof i=="number")&&(i===null&&(i=this._getPromiseDelay()),d.promiseDelay(i).then(()=>c("No response from Twitch.")));else return c("Not connected to server.");if(r!==null){const b=d.channel(r);this.log.info(`[${b}] Executing command: ${l}`),this.ws.send(`PRIVMSG ${b} :${l}`)}else this.log.info(`Executing command: ${l}`),this.ws.send(l);typeof g=="function"?g(h,c):h()})},_.prototype._sendMessage=function(i,r,l,g){return new Promise((h,c)=>{if(this._isConnected()){if(d.isJustinfan(this.getUsername()))return c("Cannot send anonymous messages.")}else return c("Not connected to server.");const b=d.channel(r);if(this.userstate[b]||(this.userstate[b]={}),l.length>=500){const k=d.splitLine(l,500);l=k[0],setTimeout(()=>{this._sendMessage(i,r,k[1],()=>{})},350)}this.ws.send(`PRIVMSG ${b} :${l}`);const S={};Object.keys(this.emotesets).forEach(k=>this.emotesets[k].forEach(w=>(d.isRegex(w.code)?f.emoteRegex:f.emoteString)(l,w.code,w.id,S)));const I=Object.assign(this.userstate[b],f.emotes({emotes:f.transformEmotes(S)||null})),T=d.get(this.opts.options.messagesLogLevel,"info"),C=d.actionMessage(l);C?(I["message-type"]="action",this.log[T](`[${b}] *<${this.getUsername()}>: ${C[1]}`),this.emits(["action","message"],[[b,I,C[1],!0]])):(I["message-type"]="chat",this.log[T](`[${b}] <${this.getUsername()}>: ${l}`),this.emits(["chat","message"],[[b,I,l,!0]])),typeof g=="function"?g(h,c):h()})},_.prototype._updateEmoteset=function(i){let r=i!==void 0;if(r&&(i===this.emotes?r=!1:this.emotes=i),this._skipUpdatingEmotesets){r&&this.emit("emotesets",i,{});return}const l=()=>{this._updateEmotesetsTimerDelay>0&&(clearTimeout(this._updateEmotesetsTimer),this._updateEmotesetsTimer=setTimeout(()=>this._updateEmoteset(i),this._updateEmotesetsTimerDelay))};this._getToken().then(g=>{const h=`https://api.twitch.tv/kraken/chat/emoticon_images?emotesets=${i}`,c={};return"fetchAgent"in this.opts.connection&&(c.agent=this.opts.connection.fetchAgent),o(h,{...c,headers:{Accept:"application/vnd.twitchtv.v5+json",Authorization:`OAuth ${d.token(g)}`,"Client-ID":this.clientId}})}).then(g=>g.json()).then(g=>{this.emotesets=g.emoticon_sets||{},this.emit("emotesets",i,this.emotesets),l()}).catch(()=>l())},_.prototype.getUsername=function(){return this.username},_.prototype.getOptions=function(){return this.opts},_.prototype.getChannels=function(){return this.channels},_.prototype.isMod=function(i,r){const l=d.channel(i);return this.moderators[l]||(this.moderators[l]=[]),this.moderators[l].includes(d.username(r))},_.prototype.readyState=function(){return this.ws===null?"CLOSED":["CONNECTING","OPEN","CLOSING","CLOSED"][this.ws.readyState]},_.prototype._isConnected=function(){return this.ws!==null&&this.ws.readyState===1},_.prototype.disconnect=function(){return new Promise((i,r)=>{this.ws!==null&&this.ws.readyState!==3?(this.wasCloseCalled=!0,this.log.info("Disconnecting from server.."),this.ws.close(),this.once("_promiseDisconnect",()=>i([this.server,~~this.port]))):(this.log.error("Cannot disconnect from server. Socket is not opened or connection is already closing."),r("Cannot disconnect from server. Socket is not opened or connection is already closing."))})},_.prototype.off=_.prototype.removeListener,e.exports&&(e.exports=_),typeof window<"u"&&(window.tmi={client:_,Client:_})})(je);var gt=je.exports;const Ee=gt;var bt={client:Ee,Client:Ee};const _t=Pe(bt),Te=e=>{let t;const s=new Set,o=(f,v)=>{const d=typeof f=="function"?f(t):f;if(!Object.is(d,t)){const x=t;t=v??typeof d!="object"?d:Object.assign({},t,d),s.forEach(_=>_(t,x))}},n=()=>t,m={setState:o,getState:n,subscribe:f=>(s.add(f),()=>s.delete(f)),destroy:()=>{({BASE_URL:"/numerica-rothio-skin/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}};return t=e(o,n,m),m},vt=e=>e?Te(e):Te;var ze={exports:{}},Be={},Fe={exports:{}},We={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J=A;function wt(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yt=typeof Object.is=="function"?Object.is:wt,xt=J.useState,Ct=J.useEffect,kt=J.useLayoutEffect,St=J.useDebugValue;function Et(e,t){var s=t(),o=xt({inst:{value:s,getSnapshot:t}}),n=o[0].inst,a=o[1];return kt(function(){n.value=s,n.getSnapshot=t,ae(n)&&a({inst:n})},[e,s,t]),Ct(function(){return ae(n)&&a({inst:n}),e(function(){ae(n)&&a({inst:n})})},[e]),St(s),s}function ae(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!yt(e,s)}catch{return!0}}function Tt(e,t){return t()}var $t=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Tt:Et;We.useSyncExternalStore=J.useSyncExternalStore!==void 0?J.useSyncExternalStore:$t;Fe.exports=We;var It=Fe.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe=A,Rt=It;function Mt(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nt=typeof Object.is=="function"?Object.is:Mt,Lt=Rt.useSyncExternalStore,At=oe.useRef,Ot=oe.useEffect,Pt=oe.useMemo,jt=oe.useDebugValue;Be.useSyncExternalStoreWithSelector=function(e,t,s,o,n){var a=At(null);if(a.current===null){var u={hasValue:!1,value:null};a.current=u}else u=a.current;a=Pt(function(){function f(p){if(!v){if(v=!0,d=p,p=o(p),n!==void 0&&u.hasValue){var i=u.value;if(n(i,p))return x=i}return x=p}if(i=x,Nt(d,p))return i;var r=o(p);return n!==void 0&&n(i,r)?i:(d=p,x=r)}var v=!1,d,x,_=s===void 0?null:s;return[function(){return f(t())},_===null?void 0:function(){return f(_())}]},[t,s,o,n]);var m=Lt(e,a[0],a[1]);return Ot(function(){u.hasValue=!0,u.value=m},[m]),jt(m),m};ze.exports=Be;var Ut=ze.exports;const Gt=Pe(Ut),{useSyncExternalStoreWithSelector:Dt}=Gt;function zt(e,t=e.getState,s){const o=Dt(e.subscribe,e.getState,e.getServerState||e.getState,t,s);return A.useDebugValue(o),o}const $e=e=>{({BASE_URL:"/numerica-rothio-skin/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?vt(e):e,s=(o,n)=>zt(t,o,n);return Object.assign(s,t),s},Bt=e=>e?$e(e):$e;function Ft(e,t){let s;try{s=e()}catch{return}return{getItem:n=>{var a;const u=f=>f===null?null:JSON.parse(f,t==null?void 0:t.reviver),m=(a=s.getItem(n))!=null?a:null;return m instanceof Promise?m.then(u):u(m)},setItem:(n,a)=>s.setItem(n,JSON.stringify(a,t==null?void 0:t.replacer)),removeItem:n=>s.removeItem(n)}}const Z=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(o){return Z(o)(s)},catch(o){return this}}}catch(s){return{then(o){return this},catch(o){return Z(o)(s)}}}},Wt=(e,t)=>(s,o,n)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:l=>l,version:0,merge:(l,g)=>({...g,...l}),...t},u=!1;const m=new Set,f=new Set;let v;try{v=a.getStorage()}catch{}if(!v)return e((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...l)},o,n);const d=Z(a.serialize),x=()=>{const l=a.partialize({...o()});let g;const h=d({state:l,version:a.version}).then(c=>v.setItem(a.name,c)).catch(c=>{g=c});if(g)throw g;return h},_=n.setState;n.setState=(l,g)=>{_(l,g),x()};const p=e((...l)=>{s(...l),x()},o,n);let i;const r=()=>{var l;if(!v)return;u=!1,m.forEach(h=>h(o()));const g=((l=a.onRehydrateStorage)==null?void 0:l.call(a,o()))||void 0;return Z(v.getItem.bind(v))(a.name).then(h=>{if(h)return a.deserialize(h)}).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==a.version){if(a.migrate)return a.migrate(h.state,h.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return h.state}).then(h=>{var c;return i=a.merge(h,(c=o())!=null?c:p),s(i,!0),x()}).then(()=>{g==null||g(i,void 0),u=!0,f.forEach(h=>h(i))}).catch(h=>{g==null||g(void 0,h)})};return n.persist={setOptions:l=>{a={...a,...l},l.getStorage&&(v=l.getStorage())},clearStorage:()=>{v==null||v.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>r(),hasHydrated:()=>u,onHydrate:l=>(m.add(l),()=>{m.delete(l)}),onFinishHydration:l=>(f.add(l),()=>{f.delete(l)})},r(),i||p},Jt=(e,t)=>(s,o,n)=>{let a={storage:Ft(()=>localStorage),partialize:r=>r,version:0,merge:(r,l)=>({...l,...r}),...t},u=!1;const m=new Set,f=new Set;let v=a.storage;if(!v)return e((...r)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...r)},o,n);const d=()=>{const r=a.partialize({...o()});return v.setItem(a.name,{state:r,version:a.version})},x=n.setState;n.setState=(r,l)=>{x(r,l),d()};const _=e((...r)=>{s(...r),d()},o,n);let p;const i=()=>{var r,l;if(!v)return;u=!1,m.forEach(h=>{var c;return h((c=o())!=null?c:_)});const g=((l=a.onRehydrateStorage)==null?void 0:l.call(a,(r=o())!=null?r:_))||void 0;return Z(v.getItem.bind(v))(a.name).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==a.version){if(a.migrate)return a.migrate(h.state,h.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return h.state}).then(h=>{var c;return p=a.merge(h,(c=o())!=null?c:_),s(p,!0),d()}).then(()=>{g==null||g(p,void 0),p=o(),u=!0,f.forEach(h=>h(p))}).catch(h=>{g==null||g(void 0,h)})};return n.persist={setOptions:r=>{a={...a,...r},r.storage&&(v=r.storage)},clearStorage:()=>{v==null||v.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>i(),hasHydrated:()=>u,onHydrate:r=>(m.add(r),()=>{m.delete(r)}),onFinishHydration:r=>(f.add(r),()=>{f.delete(r)})},a.skipHydration||i(),p||_},Ht=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?(({BASE_URL:"/numerica-rothio-skin/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Wt(e,t)):Jt(e,t),Vt=Ht;function Ie(e,t,s){return Math.min(Math.max(t,e),s)}function Re(e,t,s){return(t-e)*s+e}function qt(){for(var e=0,t,s,o="";e<arguments.length;)(t=arguments[e++])&&(s=Je(t))&&(o&&(o+=" "),o+=s);return o}function Je(e){if(typeof e=="string")return e;for(var t,s="",o=0;o<e.length;o++)e[o]&&(t=Je(e[o]))&&(s&&(s+=" "),s+=t);return s}var ue="-";function Qt(e){var t=Zt(e),s=e.conflictingClassGroups,o=e.conflictingClassGroupModifiers,n=o===void 0?{}:o;function a(m){var f=m.split(ue);return f[0]===""&&f.length!==1&&f.shift(),He(f,t)||Xt(m)}function u(m,f){var v=s[m]||[];return f&&n[m]?[].concat(v,n[m]):v}return{getClassGroupId:a,getConflictingClassGroupIds:u}}function He(e,t){var u;if(e.length===0)return t.classGroupId;var s=e[0],o=t.nextPart.get(s),n=o?He(e.slice(1),o):void 0;if(n)return n;if(t.validators.length!==0){var a=e.join(ue);return(u=t.validators.find(function(m){var f=m.validator;return f(a)}))==null?void 0:u.classGroupId}}var Me=/^\[(.+)\]$/;function Xt(e){if(Me.test(e)){var t=Me.exec(e)[1],s=t==null?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}}function Zt(e){var t=e.theme,s=e.prefix,o={nextPart:new Map,validators:[]},n=Kt(Object.entries(e.classGroups),s);return n.forEach(function(a){var u=a[0],m=a[1];ce(m,o,u,t)}),o}function ce(e,t,s,o){e.forEach(function(n){if(typeof n=="string"){var a=n===""?t:Ne(t,n);a.classGroupId=s;return}if(typeof n=="function"){if(Yt(n)){ce(n(o),t,s,o);return}t.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(function(u){var m=u[0],f=u[1];ce(f,Ne(t,m),s,o)})})}function Ne(e,t){var s=e;return t.split(ue).forEach(function(o){s.nextPart.has(o)||s.nextPart.set(o,{nextPart:new Map,validators:[]}),s=s.nextPart.get(o)}),s}function Yt(e){return e.isThemeGetter}function Kt(e,t){return t?e.map(function(s){var o=s[0],n=s[1],a=n.map(function(u){return typeof u=="string"?t+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(function(m){var f=m[0],v=m[1];return[t+f,v]})):u});return[o,a]}):e}function es(e){if(e<1)return{get:function(){},set:function(){}};var t=0,s=new Map,o=new Map;function n(a,u){s.set(a,u),t++,t>e&&(t=0,o=s,s=new Map)}return{get:function(u){var m=s.get(u);if(m!==void 0)return m;if((m=o.get(u))!==void 0)return n(u,m),m},set:function(u,m){s.has(u)?s.set(u,m):n(u,m)}}}var Ve="!";function ts(e){var t=e.separator||":",s=t.length===1,o=t[0],n=t.length;return function(u){for(var m=[],f=0,v=0,d,x=0;x<u.length;x++){var _=u[x];if(f===0){if(_===o&&(s||u.slice(x,x+n)===t)){m.push(u.slice(v,x)),v=x+n;continue}if(_==="/"){d=x;continue}}_==="["?f++:_==="]"&&f--}var p=m.length===0?u:u.substring(v),i=p.startsWith(Ve),r=i?p.substring(1):p,l=d&&d>v?d-v:void 0;return{modifiers:m,hasImportantModifier:i,baseClassName:r,maybePostfixModifierPosition:l}}}function ss(e){if(e.length<=1)return e;var t=[],s=[];return e.forEach(function(o){var n=o[0]==="[";n?(t.push.apply(t,s.sort().concat([o])),s=[]):s.push(o)}),t.push.apply(t,s.sort()),t}function os(e){return{cache:es(e.cacheSize),splitModifiers:ts(e),...Qt(e)}}var rs=/\s+/;function ns(e,t){var s=t.splitModifiers,o=t.getClassGroupId,n=t.getConflictingClassGroupIds,a=new Set;return e.trim().split(rs).map(function(u){var m=s(u),f=m.modifiers,v=m.hasImportantModifier,d=m.baseClassName,x=m.maybePostfixModifierPosition,_=o(x?d.substring(0,x):d),p=!!x;if(!_){if(!x)return{isTailwindClass:!1,originalClassName:u};if(_=o(d),!_)return{isTailwindClass:!1,originalClassName:u};p=!1}var i=ss(f).join(":"),r=v?i+Ve:i;return{isTailwindClass:!0,modifierId:r,classGroupId:_,originalClassName:u,hasPostfixModifier:p}}).reverse().filter(function(u){if(!u.isTailwindClass)return!0;var m=u.modifierId,f=u.classGroupId,v=u.hasPostfixModifier,d=m+f;return a.has(d)?!1:(a.add(d),n(f,v).forEach(function(x){return a.add(m+x)}),!0)}).reverse().map(function(u){return u.originalClassName}).join(" ")}function is(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var o,n,a,u=m;function m(v){var d=t[0],x=t.slice(1),_=x.reduce(function(p,i){return i(p)},d());return o=os(_),n=o.cache.get,a=o.cache.set,u=f,f(v)}function f(v){var d=n(v);if(d)return d;var x=ns(v,o);return a(v,x),x}return function(){return u(qt.apply(null,arguments))}}function E(e){var t=function(o){return o[e]||[]};return t.isThemeGetter=!0,t}var qe=/^\[(?:([a-z-]+):)?(.+)\]$/i,as=/^\d+\/\d+$/,ls=new Set(["px","full","screen"]),cs=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,us=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|^0$/,ds=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function O(e){return z(e)||ls.has(e)||as.test(e)||D(e)}function D(e){return B(e,"length",bs)}function hs(e){return B(e,"size",Qe)}function ms(e){return B(e,"position",Qe)}function fs(e){return B(e,"url",_s)}function se(e){return B(e,"number",z)}function z(e){return!Number.isNaN(Number(e))}function ps(e){return e.endsWith("%")&&z(e.slice(0,-1))}function q(e){return Le(e)||B(e,"number",Le)}function $(e){return qe.test(e)}function Q(){return!0}function G(e){return cs.test(e)}function gs(e){return B(e,"",vs)}function B(e,t,s){var o=qe.exec(e);return o?o[1]?o[1]===t:s(o[2]):!1}function bs(e){return us.test(e)}function Qe(){return!1}function _s(e){return e.startsWith("url(")}function Le(e){return Number.isInteger(Number(e))}function vs(e){return ds.test(e)}function ws(){var e=E("colors"),t=E("spacing"),s=E("blur"),o=E("brightness"),n=E("borderColor"),a=E("borderRadius"),u=E("borderSpacing"),m=E("borderWidth"),f=E("contrast"),v=E("grayscale"),d=E("hueRotate"),x=E("invert"),_=E("gap"),p=E("gradientColorStops"),i=E("gradientColorStopPositions"),r=E("inset"),l=E("margin"),g=E("opacity"),h=E("padding"),c=E("saturate"),b=E("scale"),S=E("sepia"),I=E("skew"),T=E("space"),C=E("translate"),k=function(){return["auto","contain","none"]},w=function(){return["auto","hidden","clip","visible","scroll"]},R=function(){return["auto",t]},P=function(){return["",O]},U=function(){return["auto",z,$]},de=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},K=function(){return["solid","dashed","dotted","double","none"]},he=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},re=function(){return["start","end","center","between","around","evenly","stretch"]},H=function(){return["","0",$]},me=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},V=function(){return[z,se]},ee=function(){return[z,$]};return{cacheSize:500,theme:{colors:[Q],spacing:[O],blur:["none","",G,D],brightness:V(),borderColor:[e],borderRadius:["none","","full",G,D],borderSpacing:[t],borderWidth:P(),contrast:V(),grayscale:H(),hueRotate:ee(),invert:H(),gap:[t],gradientColorStops:[e],gradientColorStopPositions:[ps,D],inset:R(),margin:R(),opacity:V(),padding:[t],saturate:V(),scale:V(),sepia:H(),skew:ee(),space:[t],translate:[t]},classGroups:{aspect:[{aspect:["auto","square","video",$]}],container:["container"],columns:[{columns:[G]}],"break-after":[{"break-after":me()}],"break-before":[{"break-before":me()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(de(),[$])}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[r]}],"inset-x":[{"inset-x":[r]}],"inset-y":[{"inset-y":[r]}],start:[{start:[r]}],end:[{end:[r]}],top:[{top:[r]}],right:[{right:[r]}],bottom:[{bottom:[r]}],left:[{left:[r]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",q]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",$]}],grow:[{grow:H()}],shrink:[{shrink:H()}],order:[{order:["first","last","none",q]}],"grid-cols":[{"grid-cols":[Q]}],"col-start-end":[{col:["auto",{span:[q]},$]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[Q]}],"row-start-end":[{row:["auto",{span:[q]},$]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",$]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",$]}],gap:[{gap:[_]}],"gap-x":[{"gap-x":[_]}],"gap-y":[{"gap-y":[_]}],"justify-content":[{justify:["normal"].concat(re())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(re(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(re(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[h]}],px:[{px:[h]}],py:[{py:[h]}],ps:[{ps:[h]}],pe:[{pe:[h]}],pt:[{pt:[h]}],pr:[{pr:[h]}],pb:[{pb:[h]}],pl:[{pl:[h]}],m:[{m:[l]}],mx:[{mx:[l]}],my:[{my:[l]}],ms:[{ms:[l]}],me:[{me:[l]}],mt:[{mt:[l]}],mr:[{mr:[l]}],mb:[{mb:[l]}],ml:[{ml:[l]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",t]}],"min-w":[{"min-w":["min","max","fit",O]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[G]},G,D]}],h:[{h:[t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",O]}],"max-h":[{"max-h":[t,"min","max","fit"]}],"font-size":[{text:["base",G,D]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",se]}],"font-family":[{font:[Q]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",D]}],"line-clamp":[{"line-clamp":["none",z,se]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",O]}],"list-image":[{"list-image":["none",$]}],"list-style-type":[{list:["none","disc","decimal",$]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(K(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",O]}],"underline-offset":[{"underline-offset":["auto",O]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:[t]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",D]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(de(),[ms])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",hs]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},fs]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[i]}],"gradient-via-pos":[{via:[i]}],"gradient-to-pos":[{to:[i]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[m]}],"border-w-x":[{"border-x":[m]}],"border-w-y":[{"border-y":[m]}],"border-w-s":[{"border-s":[m]}],"border-w-e":[{"border-e":[m]}],"border-w-t":[{"border-t":[m]}],"border-w-r":[{"border-r":[m]}],"border-w-b":[{"border-b":[m]}],"border-w-l":[{"border-l":[m]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[].concat(K(),["hidden"])}],"divide-x":[{"divide-x":[m]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[m]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:K()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:[""].concat(K())}],"outline-offset":[{"outline-offset":[O]}],"outline-w":[{outline:[O]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[O]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",G,gs]}],"shadow-color":[{shadow:[Q]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":he()}],"bg-blend":[{"bg-blend":he()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[o]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",G,$]}],grayscale:[{grayscale:[v]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[x]}],saturate:[{saturate:[c]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[c]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[u]}],"border-spacing-x":[{"border-spacing-x":[u]}],"border-spacing-y":[{"border-spacing-y":[u]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",$]}],duration:[{duration:ee()}],ease:[{ease:["linear","in","out","in-out",$]}],delay:[{delay:ee()}],animate:[{animate:["none","spin","ping","pulse","bounce",$]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[q,$]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[I]}],"skew-y":[{"skew-y":[I]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",$]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":[t]}],"scroll-mx":[{"scroll-mx":[t]}],"scroll-my":[{"scroll-my":[t]}],"scroll-ms":[{"scroll-ms":[t]}],"scroll-me":[{"scroll-me":[t]}],"scroll-mt":[{"scroll-mt":[t]}],"scroll-mr":[{"scroll-mr":[t]}],"scroll-mb":[{"scroll-mb":[t]}],"scroll-ml":[{"scroll-ml":[t]}],"scroll-p":[{"scroll-p":[t]}],"scroll-px":[{"scroll-px":[t]}],"scroll-py":[{"scroll-py":[t]}],"scroll-ps":[{"scroll-ps":[t]}],"scroll-pe":[{"scroll-pe":[t]}],"scroll-pt":[{"scroll-pt":[t]}],"scroll-pr":[{"scroll-pr":[t]}],"scroll-pb":[{"scroll-pb":[t]}],"scroll-pl":[{"scroll-pl":[t]}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[O,se]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var ys=is(ws);const Ae=1e4,Oe=4,xs=1e3,Cs=40,ks=Bt(Vt(e=>({status:"IDLE",number:0,user:"",maxScore:0,maxScoreUser:"",registerNewNumber:(t,s)=>{e(o=>o.user===s?{}:t===o.number+1?t>o.maxScore?{status:"STARTED",number:o.number+1,user:s,maxScore:o.number+1,maxScoreUser:s}:{status:"STARTED",number:o.number+1,user:s}:{status:o.number===0?"IDLE":"GAME_OVER",number:0,user:s})},setMaxScore:(t,s)=>{e(()=>({maxScore:t,maxScoreUser:s}))}}),{name:"numerica",version:1}));function Es(){const{channel:e}=Ze(),{status:t,number:s,user:o,maxScore:n,maxScoreUser:a,registerNewNumber:u,setMaxScore:m}=ks(),[f,v]=A.useState(null),d=A.useRef(null),x=A.useRef({duration:Ae,numberOfBubbles:Oe});A.useEffect(()=>{const p=new URL(window.location.href),i=new URLSearchParams(p.hash.substr(1)),r=i.get("maxScore"),l=i.get("maxScoreUser"),g=Number(r),h=isFinite(g),c=g%1===0,b=g>0;!r||!l||!h||!c||!b||g<n||m(g,l)},[]),A.useEffect(()=>{if(!e)return;const p=new _t.Client({channels:[e]});return p.connect().catch(console.error),v(p),()=>{p.disconnect().catch(console.error)}},[e]);const _=A.useCallback((p,i,r,l)=>{if(l)return;const g=i.displayName||i.username;if(!g)return;const h=Number(r),c=isFinite(h),b=h%1===0,S=h>0;!c||!b||!S||u(h,g)},[u]);return A.useEffect(()=>{if(f)return f.on("message",_),()=>{f.removeListener("message",_)}},[f,_]),A.useEffect(()=>{const p=Ie(0,s,50)/Ie(5,n,50);x.current={duration:Math.round(Re(Ae,xs,p)),numberOfBubbles:Math.round(Re(Oe,Cs,p))}},[s,n]),A.useEffect(()=>{let p=null,i=0;const r=l=>{if(!d.current)return;const{duration:g,numberOfBubbles:h}=x.current;if(g/h<l-i){const S=Math.random()*Math.PI*2,I=Math.sin(S)*35+50,T=Math.cos(S)*35+50,C=document.createElement("div");C.classList.add("absolute"),C.classList.add("bg-white"),C.classList.add("rounded-full"),C.classList.add("top-1/2"),C.classList.add("left-1/2"),C.classList.add("-translate-y-1/2"),C.classList.add("-translate-x-1/2"),C.classList.add("animate-bubble"),C.style.setProperty("--target-top",`${I}%`),C.style.setProperty("--target-left",`${T}%`),C.style.setProperty("--animation-duration",`${g}ms`),d.current.appendChild(C),setTimeout(()=>{var k;(k=d.current)==null||k.removeChild(C)},g),i=l}p=requestAnimationFrame(r)};return p=requestAnimationFrame(r),()=>{p&&cancelAnimationFrame(p)}},[]),N.jsxs("div",{className:"relative",children:[N.jsxs("div",{className:"overflow-hidden relative flex items-center justify-center w-[400px] h-[400px] rounded-full ",children:[[s-1,s].map(p=>p<0?null:N.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-[200px] h-[200px] flex justify-center items-center bg-black p-4 rounded-full overflow-hidden mix-blend-screen contrast-[100]",children:N.jsx("span",{className:ys("text-8xl font-bold leading-tight text-white blur-[1px]",p===s?"animate-bubble-fade-in":"animate-bubble-fade-out opacity-0"),children:p})},p)),N.jsxs("div",{className:"absolute -inset-[100px]",children:[N.jsx("div",{className:"absolute inset-0 bg-primary"}),N.jsx("div",{className:"absolute inset-0 bg-black blur-lg contrast-[100] flex items-center justify-center mix-blend-multiply",ref:d,children:N.jsx("div",{className:"bg-white w-[200px] h-[200px] rounded-full"})})]})]}),N.jsxs("p",{className:"text-xl font-bold text-white bg-primary py-2 px-6 rounded-3xl absolute top-0 left-1/2 -translate-x-1/2 whitespace-nowrap text-center",children:["Max Score: ",n,a&&N.jsxs(N.Fragment,{children:[N.jsx("br",{}),"by ",a]})]}),(t==="GAME_OVER"||t==="STARTED")&&N.jsx("p",{className:"text-xl font-bold text-white bg-primary py-2 px-6 rounded-3xl absolute bottom-0 left-1/2 -translate-x-1/2 whitespace-nowrap text-center",children:t==="GAME_OVER"?`Blame on ${o}!`:o})]})}export{Es as default};
