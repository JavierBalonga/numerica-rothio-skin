import{g as st,c as ge,a as Ue,j as C,r as A,u as ot}from"./index-84b72360.js";var De={exports:{}};const rt={},nt=Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})),ce=st(nt);var Ge={exports:{}};const it=/^\u0001ACTION ([^\u0001]+)\u0001$/,at=/^(justinfan)(\d+$)/,lt=/\\([sn:r\\])/g,ct=/([ \n;\r\\])/g,be={s:" ",n:"",":":";",r:""},ve={" ":"s","\n":"n",";":":","\r":"r"},ut=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),dt=/[|\\^$*+?:#]/,te=Ge.exports={get:(e,t)=>typeof e>"u"?t:e,hasOwn:(e,t)=>({}).hasOwnProperty.call(e,t),promiseDelay:e=>new Promise(t=>setTimeout(t,e)),isFinite:e=>isFinite(e)&&!isNaN(parseFloat(e)),toNumber(e,t){if(e===null)return 0;const s=Math.pow(10,te.isFinite(t)?t:0);return Math.round(e*s)/s},isInteger:e=>!isNaN(te.toNumber(e,0)),isRegex:e=>dt.test(e),isURL:e=>ut.test(e),justinfan:()=>`justinfan${Math.floor(Math.random()*8e4+1e3)}`,isJustinfan:e=>at.test(e),channel(e){const t=(e||"").toLowerCase();return t[0]==="#"?t:"#"+t},username(e){const t=(e||"").toLowerCase();return t[0]==="#"?t.slice(1):t},token:e=>e?e.toLowerCase().replace("oauth:",""):"",password(e){const t=te.token(e);return t?`oauth:${t}`:""},actionMessage:e=>e.match(it),replaceAll(e,t){if(e===null||typeof e>"u")return null;for(const s in t)e=e.replace(new RegExp(s,"g"),t[s]);return e},unescapeHtml:e=>e.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'"),unescapeIRC(e){return!e||typeof e!="string"||!e.includes("\\")?e:e.replace(lt,(t,s)=>s in be?be[s]:s)},escapeIRC(e){return!e||typeof e!="string"?e:e.replace(ct,(t,s)=>s in ve?`\\${ve[s]}`:s)},addWord:(e,t)=>e.length?e+" "+t:e+t,splitLine(e,t){let s=e.substring(0,t).lastIndexOf(" ");return s===-1&&(s=t-1),[e.substring(0,s),e.substring(s+1)]},extractNumber(e){const t=e.split(" ");for(let s=0;s<t.length;s++)if(te.isInteger(t[s]))return~~t[s];return 0},formatDate(e){let t=e.getHours(),s=e.getMinutes();return t=(t<10?"0":"")+t,s=(s<10?"0":"")+s,`${t}:${s}`},inherits(e,t){e.super_=t;const s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e},isNode(){try{return typeof process=="object"&&Object.prototype.toString.call(process)==="[object process]"}catch{}return!1}};var Y=Ge.exports;const ht=ce,_e=Y;var mt=function(t,s){let o=t.url!==void 0?t.url:t.uri;if(_e.isURL(o)||(o=`https://api.twitch.tv/kraken${o[0]==="/"?o:`/${o}`}`),_e.isNode()){const n=Object.assign({method:"GET",json:!0},t);if(n.qs){const f=new URLSearchParams(n.qs);o+=`?${f}`}const i={};"fetchAgent"in this.opts.connection&&(i.agent=this.opts.connection.fetchAgent);const u=ht(o,{...i,method:n.method,headers:n.headers,body:n.body});let m={};u.then(f=>(m={statusCode:f.status,headers:f.headers},n.json?f.json():f.text())).then(f=>s(null,m,f),f=>s(f,m,null))}else{const n=Object.assign({method:"GET",headers:{}},t,{url:o}),i=new XMLHttpRequest;i.open(n.method,n.url,!0);for(const u in n.headers)i.setRequestHeader(u,n.headers[u]);i.responseType="json",i.addEventListener("load",u=>{i.readyState===4&&(i.status!==200?s(i.status,null,null):s(null,null,i.response))}),i.send()}};const y=Y;function we(e,t){return e=y.channel(e),t=y.get(t,30),this._sendCommand(null,e,`/followers ${t}`,(s,o)=>{this.once("_promiseFollowers",n=>{n?o(n):s([e,~~t])})})}function ye(e){return e=y.channel(e),this._sendCommand(null,e,"/followersoff",(t,s)=>{this.once("_promiseFollowersoff",o=>{o?s(o):t([e])})})}function xe(e){return e=y.channel(e),this._sendCommand(null,null,`PART ${e}`,(t,s)=>{this.once("_promisePart",o=>{o?s(o):t([e])})})}function Ce(e){return e=y.channel(e),this._sendCommand(null,e,"/r9kbeta",(t,s)=>{this.once("_promiseR9kbeta",o=>{o?s(o):t([e])})})}function ke(e){return e=y.channel(e),this._sendCommand(null,e,"/r9kbetaoff",(t,s)=>{this.once("_promiseR9kbetaoff",o=>{o?s(o):t([e])})})}function Se(e,t){return e=y.channel(e),t=y.get(t,300),this._sendCommand(null,e,`/slow ${t}`,(s,o)=>{this.once("_promiseSlow",n=>{n?o(n):s([e,~~t])})})}function Ee(e){return e=y.channel(e),this._sendCommand(null,e,"/slowoff",(t,s)=>{this.once("_promiseSlowoff",o=>{o?s(o):t([e])})})}var ft={action(e,t){return e=y.channel(e),t=`ACTION ${t}`,this._sendMessage(this._getPromiseDelay(),e,t,(s,o)=>{s([e,t])})},ban(e,t,s){return e=y.channel(e),t=y.username(t),s=y.get(s,""),this._sendCommand(null,e,`/ban ${t} ${s}`,(o,n)=>{this.once("_promiseBan",i=>{i?n(i):o([e,t,s])})})},clear(e){return e=y.channel(e),this._sendCommand(null,e,"/clear",(t,s)=>{this.once("_promiseClear",o=>{o?s(o):t([e])})})},color(e,t){return t=y.get(t,e),this._sendCommand(null,"#tmijs",`/color ${t}`,(s,o)=>{this.once("_promiseColor",n=>{n?o(n):s([t])})})},commercial(e,t){return e=y.channel(e),t=y.get(t,30),this._sendCommand(null,e,`/commercial ${t}`,(s,o)=>{this.once("_promiseCommercial",n=>{n?o(n):s([e,~~t])})})},deletemessage(e,t){return e=y.channel(e),this._sendCommand(null,e,`/delete ${t}`,(s,o)=>{this.once("_promiseDeletemessage",n=>{n?o(n):s([e])})})},emoteonly(e){return e=y.channel(e),this._sendCommand(null,e,"/emoteonly",(t,s)=>{this.once("_promiseEmoteonly",o=>{o?s(o):t([e])})})},emoteonlyoff(e){return e=y.channel(e),this._sendCommand(null,e,"/emoteonlyoff",(t,s)=>{this.once("_promiseEmoteonlyoff",o=>{o?s(o):t([e])})})},followersonly:we,followersmode:we,followersonlyoff:ye,followersmodeoff:ye,host(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(2e3,e,`/host ${t}`,(s,o)=>{this.once("_promiseHost",(n,i)=>{n?o(n):s([e,t,~~i])})})},join(e){return e=y.channel(e),this._sendCommand(void 0,null,`JOIN ${e}`,(t,s)=>{const o="_promiseJoin";let n=!1;const i=(m,f)=>{e===y.channel(f)&&(this.removeListener(o,i),n=!0,m?s(m):t([e]))};this.on(o,i);const u=this._getPromiseDelay();y.promiseDelay(u).then(()=>{n||this.emit(o,"No response from Twitch.",e)})})},mod(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/mod ${t}`,(s,o)=>{this.once("_promiseMod",n=>{n?o(n):s([e,t])})})},mods(e){return e=y.channel(e),this._sendCommand(null,e,"/mods",(t,s)=>{this.once("_promiseMods",(o,n)=>{o?s(o):(n.forEach(i=>{this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].includes(i)||this.moderators[e].push(i)}),t(n))})})},part:xe,leave:xe,ping(){return this._sendCommand(null,null,"PING",(e,t)=>{this.latency=new Date,this.pingTimeout=setTimeout(()=>{this.ws!==null&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout))},y.get(this.opts.connection.timeout,9999)),this.once("_promisePing",s=>e([parseFloat(s)]))})},r9kbeta:Ce,r9kmode:Ce,r9kbetaoff:ke,r9kmodeoff:ke,raw(e){return this._sendCommand(null,null,e,(t,s)=>{t([e])})},say(e,t){return e=y.channel(e),t.startsWith(".")&&!t.startsWith("..")||t.startsWith("/")||t.startsWith("\\")?t.substr(1,3)==="me "?this.action(e,t.substr(4)):this._sendCommand(null,e,t,(s,o)=>{s([e,t])}):this._sendMessage(this._getPromiseDelay(),e,t,(s,o)=>{s([e,t])})},slow:Se,slowmode:Se,slowoff:Ee,slowmodeoff:Ee,subscribers(e){return e=y.channel(e),this._sendCommand(null,e,"/subscribers",(t,s)=>{this.once("_promiseSubscribers",o=>{o?s(o):t([e])})})},subscribersoff(e){return e=y.channel(e),this._sendCommand(null,e,"/subscribersoff",(t,s)=>{this.once("_promiseSubscribersoff",o=>{o?s(o):t([e])})})},timeout(e,t,s,o){return e=y.channel(e),t=y.username(t),s!==null&&!y.isInteger(s)&&(o=s,s=300),s=y.get(s,300),o=y.get(o,""),this._sendCommand(null,e,`/timeout ${t} ${s} ${o}`,(n,i)=>{this.once("_promiseTimeout",u=>{u?i(u):n([e,t,~~s,o])})})},unban(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/unban ${t}`,(s,o)=>{this.once("_promiseUnban",n=>{n?o(n):s([e,t])})})},unhost(e){return e=y.channel(e),this._sendCommand(2e3,e,"/unhost",(t,s)=>{this.once("_promiseUnhost",o=>{o?s(o):t([e])})})},unmod(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/unmod ${t}`,(s,o)=>{this.once("_promiseUnmod",n=>{n?o(n):s([e,t])})})},unvip(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/unvip ${t}`,(s,o)=>{this.once("_promiseUnvip",n=>{n?o(n):s([e,t])})})},vip(e,t){return e=y.channel(e),t=y.username(t),this._sendCommand(null,e,`/vip ${t}`,(s,o)=>{this.once("_promiseVip",n=>{n?o(n):s([e,t])})})},vips(e){return e=y.channel(e),this._sendCommand(null,e,"/vips",(t,s)=>{this.once("_promiseVips",(o,n)=>{o?s(o):t(n)})})},whisper(e,t){return e=y.username(e),e===this.getUsername()?Promise.reject("Cannot send a whisper to the same account."):this._sendCommand(null,"#tmijs",`/w ${e} ${t}`,(s,o)=>{this.once("_promiseWhisper",n=>{n&&o(n)})}).catch(s=>{if(s&&typeof s=="string"&&s.indexOf("No response from Twitch.")!==0)throw s;const o=y.channel(e),n=Object.assign({"message-type":"whisper","message-id":null,"thread-id":null,username:this.getUsername()},this.globaluserstate);return this.emits(["whisper","message"],[[o,n,t,!0],[o,n,t,!0]]),[e,t]})}};function L(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var pt=L;L.EventEmitter=L;L.prototype._events=void 0;L.prototype._maxListeners=void 0;L.defaultMaxListeners=10;L.prototype.setMaxListeners=function(e){if(!gt(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this};L.prototype.emit=function(e){var t,s,o,n,i,u;if(this._events||(this._events={}),e==="error"&&(!this._events.error||Z(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(s=this._events[e],Be(s))return!1;if(z(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),s.apply(this,n)}else if(Z(s))for(n=Array.prototype.slice.call(arguments,1),u=s.slice(),o=u.length,i=0;i<o;i++)u[i].apply(this,n);return!0};L.prototype.addListener=function(e,t){var s;if(!z(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,z(t.listener)?t.listener:t),this._events[e]?Z(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,Z(this._events[e])&&!this._events[e].warned&&(Be(this._maxListeners)?s=L.defaultMaxListeners:s=this._maxListeners,s&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),typeof console.trace=="function"&&console.trace())),this};L.prototype.on=L.prototype.addListener;L.prototype.once=function(e,t){if(!z(t))throw TypeError("listener must be a function");var s=!1;if(this._events.hasOwnProperty(e)&&e.charAt(0)==="_"){var o=1,n=e;for(var i in this._events)this._events.hasOwnProperty(i)&&i.startsWith(n)&&o++;e=e+o}function u(){e.charAt(0)==="_"&&!isNaN(e.substr(e.length-1))&&(e=e.substring(0,e.length-1)),this.removeListener(e,u),s||(s=!0,t.apply(this,arguments))}return u.listener=t,this.on(e,u),this};L.prototype.removeListener=function(e,t){var s,o,n,i;if(!z(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=this._events[e],n=s.length,o=-1,s===t||z(s.listener)&&s.listener===t){if(delete this._events[e],this._events.hasOwnProperty(e+"2")&&e.charAt(0)==="_"){var u=e;for(var m in this._events)this._events.hasOwnProperty(m)&&m.startsWith(u)&&(isNaN(parseInt(m.substr(m.length-1)))||(this._events[e+parseInt(m.substr(m.length-1)-1)]=this._events[m],delete this._events[m]));this._events[e]=this._events[e+"1"],delete this._events[e+"1"]}this._events.removeListener&&this.emit("removeListener",e,t)}else if(Z(s)){for(i=n;i-- >0;)if(s[i]===t||s[i].listener&&s[i].listener===t){o=i;break}if(o<0)return this;s.length===1?(s.length=0,delete this._events[e]):s.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this};L.prototype.removeAllListeners=function(e){var t,s;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[e]&&delete this._events[e],this;if(arguments.length===0){for(t in this._events)t!=="removeListener"&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[e],z(s))this.removeListener(e,s);else if(s)for(;s.length;)this.removeListener(e,s[s.length-1]);return delete this._events[e],this};L.prototype.listeners=function(e){var t;return!this._events||!this._events[e]?t=[]:z(this._events[e])?t=[this._events[e]]:t=this._events[e].slice(),t};L.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(z(t))return 1;if(t)return t.length}return 0};L.listenerCount=function(e,t){return e.listenerCount(t)};function z(e){return typeof e=="function"}function gt(e){return typeof e=="number"}function Z(e){return typeof e=="object"&&e!==null}function Be(e){return e===void 0}const bt=Y;let Fe="info";const Te={trace:0,debug:1,info:2,warn:3,error:4,fatal:5};function F(e){return function(t){Te[e]>=Te[Fe]&&console.log(`[${bt.formatDate(new Date)}] ${e}: ${t}`)}}var vt={setLevel(e){Fe=e},trace:F("trace"),debug:F("debug"),info:F("info"),warn:F("warn"),error:F("error"),fatal:F("fatal")};const ie=Y,H=/\S+/g;function ae(e,t,s=",",o="/",n){const i=e[t];if(i===void 0)return e;const u=typeof i=="string";if(e[t+"-raw"]=u?i:null,i===!0)return e[t]=null,e;if(e[t]={},u){const m=i.split(s);for(let f=0;f<m.length;f++){const w=m[f].split(o);let d=w[1];n!==void 0&&d&&(d=d.split(n)),e[t][w[0]]=d||null}}return e}var _t={badges:e=>ae(e,"badges"),badgeInfo:e=>ae(e,"badge-info"),emotes:e=>ae(e,"emotes","/",":",","),emoteRegex(e,t,s,o){H.lastIndex=0;const n=new RegExp("(\\b|^|\\s)"+ie.unescapeHtml(t)+"(\\b|$|\\s)");let i;for(;(i=H.exec(e))!==null;)n.test(i[0])&&(o[s]=o[s]||[],o[s].push([i.index,H.lastIndex-1]))},emoteString(e,t,s,o){H.lastIndex=0;let n;for(;(n=H.exec(e))!==null;)n[0]===ie.unescapeHtml(t)&&(o[s]=o[s]||[],o[s].push([n.index,H.lastIndex-1]))},transformEmotes(e){let t="";return Object.keys(e).forEach(s=>{t=`${t+s}:`,e[s].forEach(o=>t=`${t+o.join("-")},`),t=`${t.slice(0,-1)}/`}),t.slice(0,-1)},formTags(e){const t=[];for(const s in e){const o=ie.escapeIRC(e[s]);t.push(`${s}=${o}`)}return`@${t.join(";")}`},msg(e){const t={raw:e,tags:{},prefix:null,command:null,params:[]};let s=0,o=0;if(e.charCodeAt(0)===64){if(o=e.indexOf(" "),o===-1)return null;const n=e.slice(1,o).split(";");for(let i=0;i<n.length;i++){const u=n[i],m=u.split("=");t.tags[m[0]]=u.substring(u.indexOf("=")+1)||!0}s=o+1}for(;e.charCodeAt(s)===32;)s++;if(e.charCodeAt(s)===58){if(o=e.indexOf(" ",s),o===-1)return null;for(t.prefix=e.slice(s+1,o),s=o+1;e.charCodeAt(s)===32;)s++}if(o=e.indexOf(" ",s),o===-1)return e.length>s?(t.command=e.slice(s),t):null;for(t.command=e.slice(s,o),s=o+1;e.charCodeAt(s)===32;)s++;for(;s<e.length;){if(o=e.indexOf(" ",s),e.charCodeAt(s)===58){t.params.push(e.slice(s+1));break}if(o!==-1){for(t.params.push(e.slice(s,o)),s=o+1;e.charCodeAt(s)===32;)s++;continue}if(o===-1){t.params.push(e.slice(s));break}}return t}};class wt{constructor(t){this.queue=[],this.index=0,this.defaultDelay=t===void 0?3e3:t}add(t,s){this.queue.push({fn:t,delay:s})}next(){const t=this.index++,s=this.queue[t];if(!s)return;const o=this.queue[this.index];if(s.fn(),o){const n=o.delay===void 0?this.defaultDelay:o.delay;setTimeout(()=>this.next(),n)}}}var yt=wt;(function(e){const t=typeof ge<"u"?ge:typeof window<"u"?window:{},s=t.WebSocket||ce,o=t.fetch||ce,n=mt,i=ft,u=pt.EventEmitter,m=vt,f=_t,w=yt,d=Y;let x=!1;const _=function b(a){if(!(this instanceof b))return new b(a);this.opts=d.get(a,{}),this.opts.channels=this.opts.channels||[],this.opts.connection=this.opts.connection||{},this.opts.identity=this.opts.identity||{},this.opts.options=this.opts.options||{},this.clientId=d.get(this.opts.options.clientId,null),this._globalDefaultChannel=d.channel(d.get(this.opts.options.globalDefaultChannel,"#tmijs")),this._skipMembership=d.get(this.opts.options.skipMembership,!1),this._skipUpdatingEmotesets=d.get(this.opts.options.skipUpdatingEmotesets,!1),this._updateEmotesetsTimer=null,this._updateEmotesetsTimerDelay=d.get(this.opts.options.updateEmotesetsTimer,6e4),this.maxReconnectAttempts=d.get(this.opts.connection.maxReconnectAttempts,1/0),this.maxReconnectInterval=d.get(this.opts.connection.maxReconnectInterval,3e4),this.reconnect=d.get(this.opts.connection.reconnect,!0),this.reconnectDecay=d.get(this.opts.connection.reconnectDecay,1.5),this.reconnectInterval=d.get(this.opts.connection.reconnectInterval,1e3),this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.secure=d.get(this.opts.connection.secure,!this.opts.connection.server&&!this.opts.connection.port),this.emotes="",this.emotesets={},this.channels=[],this.currentLatency=0,this.globaluserstate={},this.lastJoined="",this.latency=new Date,this.moderators={},this.pingLoop=null,this.pingTimeout=null,this.reason="",this.username="",this.userstate={},this.wasCloseCalled=!1,this.ws=null;let r="error";this.opts.options.debug&&(r="info"),this.log=this.opts.logger||m;try{m.setLevel(r)}catch{}this.opts.channels.forEach((l,g,h)=>h[g]=d.channel(l)),u.call(this),this.setMaxListeners(0)};d.inherits(_,u);for(const b in i)_.prototype[b]=i[b];_.prototype.emits=function(a,r){for(let l=0;l<a.length;l++){const g=l<r.length?r[l]:r[r.length-1];this.emit.apply(this,[a[l]].concat(g))}},_.prototype.api=function(...b){x||(this.log.warn("Client.prototype.api is deprecated and will be removed for version 2.0.0"),x=!0),n(...b)},_.prototype.handleMessage=function(a){if(!a)return;this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(a)),a);const r=d.channel(d.get(a.params[0],null));let l=d.get(a.params[1],null);const g=d.get(a.tags["msg-id"],null),h=a.tags=f.badges(f.badgeInfo(f.emotes(a.tags)));for(const c in h){if(c==="emote-sets"||c==="ban-duration"||c==="bits")continue;let p=h[c];typeof p=="boolean"?p=null:p==="1"?p=!0:p==="0"?p=!1:typeof p=="string"&&(p=d.unescapeIRC(p)),h[c]=p}if(a.prefix===null)switch(a.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":{const c=new Date;this.currentLatency=(c.getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break}default:this.log.warn(`Could not parse message with no prefix:
${JSON.stringify(a,null,4)}`);break}else if(a.prefix==="tmi.twitch.tv")switch(a.command){case"002":case"003":case"004":case"372":case"375":case"CAP":break;case"001":this.username=a.params[0];break;case"376":{this.log.info("Connected to server."),this.userstate[this._globalDefaultChannel]={},this.emits(["connected","_promiseConnect"],[[this.server,this.port],[null]]),this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.pingLoop=setInterval(()=>{this._isConnected()&&this.ws.send("PING"),this.latency=new Date,this.pingTimeout=setTimeout(()=>{this.ws!==null&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer))},d.get(this.opts.connection.timeout,9999))},6e4);let c=d.get(this.opts.options.joinInterval,2e3);c<300&&(c=300);const p=new w(c),S=[...new Set([...this.opts.channels,...this.channels])];this.channels=[];for(let $=0;$<S.length;$++){const E=S[$];p.add(()=>{this._isConnected()&&this.join(E).catch(T=>this.log.error(T))})}p.next();break}case"NOTICE":{const c=[null],p=[r,g,l],S=[g],$=[r,!0],E=[r,!1],T=[p,c],k=[p,S],v=`[${r}] ${l}`;switch(g){case"subs_on":this.log.info(`[${r}] This room is now in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribers"],[$,$,c]);break;case"subs_off":this.log.info(`[${r}] This room is no longer in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribersoff"],[E,E,c]);break;case"emote_only_on":this.log.info(`[${r}] This room is now in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonly"],[$,c]);break;case"emote_only_off":this.log.info(`[${r}] This room is no longer in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonlyoff"],[E,c]);break;case"slow_on":case"slow_off":break;case"followers_on_zero":case"followers_on":case"followers_off":break;case"r9k_on":this.log.info(`[${r}] This room is now in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbeta"],[$,$,c]);break;case"r9k_off":this.log.info(`[${r}] This room is no longer in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbetaoff"],[E,E,c]);break;case"room_mods":{const I=l.split(": "),N=(I.length>1?I[1]:"").toLowerCase().split(", ").filter(j=>j);this.emits(["_promiseMods","mods"],[[null,N],[r,N]]);break}case"no_mods":this.emits(["_promiseMods","mods"],[[null,[]],[r,[]]]);break;case"vips_success":{l.endsWith(".")&&(l=l.slice(0,-1));const I=l.split(": "),N=(I.length>1?I[1]:"").toLowerCase().split(", ").filter(j=>j);this.emits(["_promiseVips","vips"],[[null,N],[r,N]]);break}case"no_vips":this.emits(["_promiseVips","vips"],[[null,[]],[r,[]]]);break;case"already_banned":case"bad_ban_admin":case"bad_ban_anon":case"bad_ban_broadcaster":case"bad_ban_global_mod":case"bad_ban_mod":case"bad_ban_self":case"bad_ban_staff":case"usage_ban":this.log.info(v),this.emits(["notice","_promiseBan"],k);break;case"ban_success":this.log.info(v),this.emits(["notice","_promiseBan"],T);break;case"usage_clear":this.log.info(v),this.emits(["notice","_promiseClear"],k);break;case"usage_mods":this.log.info(v),this.emits(["notice","_promiseMods"],[p,[g,[]]]);break;case"mod_success":this.log.info(v),this.emits(["notice","_promiseMod"],T);break;case"usage_vips":this.log.info(v),this.emits(["notice","_promiseVips"],[p,[g,[]]]);break;case"usage_vip":case"bad_vip_grantee_banned":case"bad_vip_grantee_already_vip":case"bad_vip_max_vips_reached":case"bad_vip_achievement_incomplete":this.log.info(v),this.emits(["notice","_promiseVip"],[p,[g,[]]]);break;case"vip_success":this.log.info(v),this.emits(["notice","_promiseVip"],T);break;case"usage_mod":case"bad_mod_banned":case"bad_mod_mod":this.log.info(v),this.emits(["notice","_promiseMod"],k);break;case"unmod_success":this.log.info(v),this.emits(["notice","_promiseUnmod"],T);break;case"unvip_success":this.log.info(v),this.emits(["notice","_promiseUnvip"],T);break;case"usage_unmod":case"bad_unmod_mod":this.log.info(v),this.emits(["notice","_promiseUnmod"],k);break;case"usage_unvip":case"bad_unvip_grantee_not_vip":this.log.info(v),this.emits(["notice","_promiseUnvip"],k);break;case"color_changed":this.log.info(v),this.emits(["notice","_promiseColor"],T);break;case"usage_color":case"turbo_only_color":this.log.info(v),this.emits(["notice","_promiseColor"],k);break;case"commercial_success":this.log.info(v),this.emits(["notice","_promiseCommercial"],T);break;case"usage_commercial":case"bad_commercial_error":this.log.info(v),this.emits(["notice","_promiseCommercial"],k);break;case"hosts_remaining":{this.log.info(v);const I=isNaN(l[0])?0:parseInt(l[0]);this.emits(["notice","_promiseHost"],[p,[null,~~I]]);break}case"bad_host_hosting":case"bad_host_rate_exceeded":case"bad_host_error":case"usage_host":this.log.info(v),this.emits(["notice","_promiseHost"],[p,[g,null]]);break;case"already_r9k_on":case"usage_r9k_on":this.log.info(v),this.emits(["notice","_promiseR9kbeta"],k);break;case"already_r9k_off":case"usage_r9k_off":this.log.info(v),this.emits(["notice","_promiseR9kbetaoff"],k);break;case"timeout_success":this.log.info(v),this.emits(["notice","_promiseTimeout"],T);break;case"delete_message_success":this.log.info(`[${r} ${l}]`),this.emits(["notice","_promiseDeletemessage"],T);break;case"already_subs_off":case"usage_subs_off":this.log.info(v),this.emits(["notice","_promiseSubscribersoff"],k);break;case"already_subs_on":case"usage_subs_on":this.log.info(v),this.emits(["notice","_promiseSubscribers"],k);break;case"already_emote_only_off":case"usage_emote_only_off":this.log.info(v),this.emits(["notice","_promiseEmoteonlyoff"],k);break;case"already_emote_only_on":case"usage_emote_only_on":this.log.info(v),this.emits(["notice","_promiseEmoteonly"],k);break;case"usage_slow_on":this.log.info(v),this.emits(["notice","_promiseSlow"],k);break;case"usage_slow_off":this.log.info(v),this.emits(["notice","_promiseSlowoff"],k);break;case"usage_timeout":case"bad_timeout_admin":case"bad_timeout_anon":case"bad_timeout_broadcaster":case"bad_timeout_duration":case"bad_timeout_global_mod":case"bad_timeout_mod":case"bad_timeout_self":case"bad_timeout_staff":this.log.info(v),this.emits(["notice","_promiseTimeout"],k);break;case"untimeout_success":case"unban_success":this.log.info(v),this.emits(["notice","_promiseUnban"],T);break;case"usage_unban":case"bad_unban_no_ban":this.log.info(v),this.emits(["notice","_promiseUnban"],k);break;case"usage_delete":case"bad_delete_message_error":case"bad_delete_message_broadcaster":case"bad_delete_message_mod":this.log.info(v),this.emits(["notice","_promiseDeletemessage"],k);break;case"usage_unhost":case"not_hosting":this.log.info(v),this.emits(["notice","_promiseUnhost"],k);break;case"whisper_invalid_login":case"whisper_invalid_self":case"whisper_limit_per_min":case"whisper_limit_per_sec":case"whisper_restricted":case"whisper_restricted_recipient":this.log.info(v),this.emits(["notice","_promiseWhisper"],k);break;case"no_permission":case"msg_banned":case"msg_room_not_found":case"msg_channel_suspended":case"tos_ban":case"invalid_user":this.log.info(v),this.emits(["notice","_promiseBan","_promiseClear","_promiseUnban","_promiseTimeout","_promiseDeletemessage","_promiseMods","_promiseMod","_promiseUnmod","_promiseVips","_promiseVip","_promiseUnvip","_promiseCommercial","_promiseHost","_promiseUnhost","_promiseJoin","_promisePart","_promiseR9kbeta","_promiseR9kbetaoff","_promiseSlow","_promiseSlowoff","_promiseFollowers","_promiseFollowersoff","_promiseSubscribers","_promiseSubscribersoff","_promiseEmoteonly","_promiseEmoteonlyoff","_promiseWhisper"],[p,[g,r]]);break;case"msg_rejected":case"msg_rejected_mandatory":this.log.info(v),this.emit("automod",r,g,l);break;case"unrecognized_cmd":this.log.info(v),this.emit("notice",r,g,l);break;case"cmds_available":case"host_target_went_offline":case"msg_censored_broadcaster":case"msg_duplicate":case"msg_emoteonly":case"msg_verified_email":case"msg_ratelimit":case"msg_subsonly":case"msg_timedout":case"msg_bad_characters":case"msg_channel_blocked":case"msg_facebook":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_slowmode":case"msg_suspended":case"no_help":case"usage_disconnect":case"usage_help":case"usage_me":case"unavailable_command":this.log.info(v),this.emit("notice",r,g,l);break;case"host_on":case"host_off":break;default:l.includes("Login unsuccessful")||l.includes("Login authentication failed")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=l,this.log.error(this.reason),this.ws.close()):l.includes("Error logging in")||l.includes("Improperly formatted auth")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=l,this.log.error(this.reason),this.ws.close()):l.includes("Invalid NICK")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason="Invalid NICK.",this.log.error(this.reason),this.ws.close()):(this.log.warn(`Could not parse NOTICE from tmi.twitch.tv:
${JSON.stringify(a,null,4)}`),this.emit("notice",r,g,l));break}break}case"USERNOTICE":{const c=h["display-name"]||h.login,p=h["msg-param-sub-plan"]||"",S=d.unescapeIRC(d.get(h["msg-param-sub-plan-name"],""))||null,E={prime:p.includes("Prime"),plan:p,planName:S},T=~~(h["msg-param-streak-months"]||0),k=h["msg-param-recipient-display-name"]||h["msg-param-recipient-user-name"],v=~~h["msg-param-mass-gift-count"];switch(h["message-type"]=g,g){case"resub":this.emits(["resub","subanniversary"],[[r,c,T,l,h,E]]);break;case"sub":this.emits(["subscription","sub"],[[r,c,E,l,h]]);break;case"subgift":this.emit("subgift",r,c,T,k,E,h);break;case"anonsubgift":this.emit("anonsubgift",r,T,k,E,h);break;case"submysterygift":this.emit("submysterygift",r,c,v,E,h);break;case"anonsubmysterygift":this.emit("anonsubmysterygift",r,v,E,h);break;case"primepaidupgrade":this.emit("primepaidupgrade",r,c,E,h);break;case"giftpaidupgrade":{const I=h["msg-param-sender-name"]||h["msg-param-sender-login"];this.emit("giftpaidupgrade",r,c,I,h);break}case"anongiftpaidupgrade":this.emit("anongiftpaidupgrade",r,c,h);break;case"raid":{const I=h["msg-param-displayName"]||h["msg-param-login"],N=+h["msg-param-viewerCount"];this.emit("raided",r,I,N,h);break}case"ritual":{const I=h["msg-param-ritual-name"];switch(I){case"new_chatter":this.emit("newchatter",r,c,h,l);break;default:this.emit("ritual",I,r,c,h,l);break}break}default:this.emit("usernotice",g,r,h,l);break}break}case"HOSTTARGET":{const c=l.split(" "),p=~~c[1]||0;c[0]==="-"?(this.log.info(`[${r}] Exited host mode.`),this.emits(["unhost","_promiseUnhost"],[[r,p],[null]])):(this.log.info(`[${r}] Now hosting ${c[0]} for ${p} viewer(s).`),this.emit("hosting",r,c[0],p));break}case"CLEARCHAT":if(a.params.length>1){const c=d.get(a.tags["ban-duration"],null);c===null?(this.log.info(`[${r}] ${l} has been banned.`),this.emit("ban",r,l,null,a.tags)):(this.log.info(`[${r}] ${l} has been timed out for ${c} seconds.`),this.emit("timeout",r,l,null,~~c,a.tags))}else this.log.info(`[${r}] Chat was cleared by a moderator.`),this.emits(["clearchat","_promiseClear"],[[r],[null]]);break;case"CLEARMSG":if(a.params.length>1){const c=l,p=h.login;h["message-type"]="messagedeleted",this.log.info(`[${r}] ${p}'s message has been deleted.`),this.emit("messagedeleted",r,p,c,h)}break;case"RECONNECT":this.log.info("Received RECONNECT request from Twitch.."),this.log.info(`Disconnecting and reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.disconnect().catch(c=>this.log.error(c)),setTimeout(()=>this.connect().catch(c=>this.log.error(c)),this.reconnectTimer);break;case"USERSTATE":a.tags.username=this.username,a.tags["user-type"]==="mod"&&(this.moderators[r]||(this.moderators[r]=[]),this.moderators[r].includes(this.username)||this.moderators[r].push(this.username)),!d.isJustinfan(this.getUsername())&&!this.userstate[r]&&(this.userstate[r]=h,this.lastJoined=r,this.channels.push(r),this.log.info(`Joined ${r}`),this.emit("join",r,d.username(this.getUsername()),!0)),a.tags["emote-sets"]!==this.emotes&&this._updateEmoteset(a.tags["emote-sets"]),this.userstate[r]=h;break;case"GLOBALUSERSTATE":this.globaluserstate=h,this.emit("globaluserstate",h),typeof a.tags["emote-sets"]<"u"&&this._updateEmoteset(a.tags["emote-sets"]);break;case"ROOMSTATE":if(d.channel(this.lastJoined)===r&&this.emit("_promiseJoin",null,r),a.tags.channel=r,this.emit("roomstate",r,a.tags),!d.hasOwn(a.tags,"subs-only")){if(d.hasOwn(a.tags,"slow"))if(typeof a.tags.slow=="boolean"&&!a.tags.slow){const c=[r,!1,0];this.log.info(`[${r}] This room is no longer in slow mode.`),this.emits(["slow","slowmode","_promiseSlowoff"],[c,c,[null]])}else{const c=~~a.tags.slow,p=[r,!0,c];this.log.info(`[${r}] This room is now in slow mode.`),this.emits(["slow","slowmode","_promiseSlow"],[p,p,[null]])}if(d.hasOwn(a.tags,"followers-only"))if(a.tags["followers-only"]==="-1"){const c=[r,!1,0];this.log.info(`[${r}] This room is no longer in followers-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowersoff"],[c,c,[null]])}else{const c=~~a.tags["followers-only"],p=[r,!0,c];this.log.info(`[${r}] This room is now in follower-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowers"],[p,p,[null]])}}break;case"SERVERCHANGE":break;default:this.log.warn(`Could not parse message from tmi.twitch.tv:
${JSON.stringify(a,null,4)}`);break}else if(a.prefix==="jtv")switch(a.command){case"MODE":l==="+o"?(this.moderators[r]||(this.moderators[r]=[]),this.moderators[r].includes(a.params[2])||this.moderators[r].push(a.params[2]),this.emit("mod",r,a.params[2])):l==="-o"&&(this.moderators[r]||(this.moderators[r]=[]),this.moderators[r].filter(c=>c!==a.params[2]),this.emit("unmod",r,a.params[2]));break;default:this.log.warn(`Could not parse message from jtv:
${JSON.stringify(a,null,4)}`);break}else switch(a.command){case"353":this.emit("names",a.params[2],a.params[3].split(" "));break;case"366":break;case"JOIN":{const c=a.prefix.split("!")[0];d.isJustinfan(this.getUsername())&&this.username===c&&(this.lastJoined=r,this.channels.push(r),this.log.info(`Joined ${r}`),this.emit("join",r,c,!0)),this.username!==c&&this.emit("join",r,c,!1);break}case"PART":{let c=!1;const p=a.prefix.split("!")[0];if(this.username===p){c=!0,this.userstate[r]&&delete this.userstate[r];let S=this.channels.indexOf(r);S!==-1&&this.channels.splice(S,1),S=this.opts.channels.indexOf(r),S!==-1&&this.opts.channels.splice(S,1),this.log.info(`Left ${r}`),this.emit("_promisePart",null)}this.emit("part",r,p,c);break}case"WHISPER":{const c=a.prefix.split("!")[0];this.log.info(`[WHISPER] <${c}>: ${l}`),d.hasOwn(a.tags,"username")||(a.tags.username=c),a.tags["message-type"]="whisper";const p=d.channel(a.tags.username);this.emits(["whisper","message"],[[p,a.tags,l,!1]]);break}case"PRIVMSG":if(a.tags.username=a.prefix.split("!")[0],a.tags.username==="jtv"){const c=d.username(l.split(" ")[0]),p=l.includes("auto");if(l.includes("hosting you for")){const S=d.extractNumber(l);this.emit("hosted",r,c,S,p)}else l.includes("hosting you")&&this.emit("hosted",r,c,0,p)}else{const c=d.get(this.opts.options.messagesLogLevel,"info"),p=d.actionMessage(l);if(a.tags["message-type"]=p?"action":"chat",l=p?p[1]:l,d.hasOwn(a.tags,"bits"))this.emit("cheer",r,a.tags,l);else{if(d.hasOwn(a.tags,"msg-id")){if(a.tags["msg-id"]==="highlighted-message"){const S=a.tags["msg-id"];this.emit("redeem",r,a.tags.username,S,a.tags,l)}else if(a.tags["msg-id"]==="skip-subs-mode-message"){const S=a.tags["msg-id"];this.emit("redeem",r,a.tags.username,S,a.tags,l)}}else if(d.hasOwn(a.tags,"custom-reward-id")){const S=a.tags["custom-reward-id"];this.emit("redeem",r,a.tags.username,S,a.tags,l)}p?(this.log[c](`[${r}] *<${a.tags.username}>: ${l}`),this.emits(["action","message"],[[r,a.tags,l,!1]])):(this.log[c](`[${r}] <${a.tags.username}>: ${l}`),this.emits(["chat","message"],[[r,a.tags,l,!1]]))}}break;default:this.log.warn(`Could not parse message:
${JSON.stringify(a,null,4)}`);break}},_.prototype.connect=function(){return new Promise((a,r)=>{this.server=d.get(this.opts.connection.server,"irc-ws.chat.twitch.tv"),this.port=d.get(this.opts.connection.port,80),this.secure&&(this.port=443),this.port===443&&(this.secure=!0),this.reconnectTimer=this.reconnectTimer*this.reconnectDecay,this.reconnectTimer>=this.maxReconnectInterval&&(this.reconnectTimer=this.maxReconnectInterval),this._openConnection(),this.once("_promiseConnect",l=>{l?r(l):a([this.server,~~this.port])})})},_.prototype._openConnection=function(){const a=`${this.secure?"wss":"ws"}://${this.server}:${this.port}/`,r={};"agent"in this.opts.connection&&(r.agent=this.opts.connection.agent),this.ws=new s(a,"irc",r),this.ws.onmessage=this._onMessage.bind(this),this.ws.onerror=this._onError.bind(this),this.ws.onclose=this._onClose.bind(this),this.ws.onopen=this._onOpen.bind(this)},_.prototype._onOpen=function(){this._isConnected()&&(this.log.info(`Connecting to ${this.server} on port ${this.port}..`),this.emit("connecting",this.server,~~this.port),this.username=d.get(this.opts.identity.username,d.justinfan()),this._getToken().then(a=>{const r=d.password(a);this.log.info("Sending authentication to server.."),this.emit("logon");let l="twitch.tv/tags twitch.tv/commands";this._skipMembership||(l+=" twitch.tv/membership"),this.ws.send("CAP REQ :"+l),r?this.ws.send(`PASS ${r}`):d.isJustinfan(this.username)&&this.ws.send("PASS SCHMOOPIIE"),this.ws.send(`NICK ${this.username}`)}).catch(a=>{this.emits(["_promiseConnect","disconnected"],[[a],["Could not get a token."]])}))},_.prototype._getToken=function(){const a=this.opts.identity.password;let r;return typeof a=="function"?(r=a(),r instanceof Promise?r:Promise.resolve(r)):Promise.resolve(a)},_.prototype._onMessage=function(a){a.data.trim().split(`\r
`).forEach(l=>{const g=f.msg(l);g&&this.handleMessage(g)})},_.prototype._onError=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.reason=this.ws===null?"Connection closed.":"Unable to connect.",this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout(()=>{this.reconnecting=!1,this.connect().catch(a=>this.log.error(a))},this.reconnectTimer)),this.ws=null},_.prototype._onClose=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.wasCloseCalled?(this.wasCloseCalled=!1,this.reason="Connection closed.",this.log.info(this.reason),this.emits(["_promiseConnect","_promiseDisconnect","disconnected"],[[this.reason],[null],[this.reason]])):(this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Could not connect to server. Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout(()=>{this.reconnecting=!1,this.connect().catch(a=>this.log.error(a))},this.reconnectTimer))),this.ws=null},_.prototype._getPromiseDelay=function(){return this.currentLatency<=600?600:this.currentLatency+100},_.prototype._sendCommand=function(a,r,l,g){return new Promise((h,c)=>{if(this._isConnected())(a===null||typeof a=="number")&&(a===null&&(a=this._getPromiseDelay()),d.promiseDelay(a).then(()=>c("No response from Twitch.")));else return c("Not connected to server.");if(r!==null){const p=d.channel(r);this.log.info(`[${p}] Executing command: ${l}`),this.ws.send(`PRIVMSG ${p} :${l}`)}else this.log.info(`Executing command: ${l}`),this.ws.send(l);typeof g=="function"?g(h,c):h()})},_.prototype._sendMessage=function(a,r,l,g){return new Promise((h,c)=>{if(this._isConnected()){if(d.isJustinfan(this.getUsername()))return c("Cannot send anonymous messages.")}else return c("Not connected to server.");const p=d.channel(r);if(this.userstate[p]||(this.userstate[p]={}),l.length>=500){const k=d.splitLine(l,500);l=k[0],setTimeout(()=>{this._sendMessage(a,r,k[1],()=>{})},350)}this.ws.send(`PRIVMSG ${p} :${l}`);const S={};Object.keys(this.emotesets).forEach(k=>this.emotesets[k].forEach(v=>(d.isRegex(v.code)?f.emoteRegex:f.emoteString)(l,v.code,v.id,S)));const $=Object.assign(this.userstate[p],f.emotes({emotes:f.transformEmotes(S)||null})),E=d.get(this.opts.options.messagesLogLevel,"info"),T=d.actionMessage(l);T?($["message-type"]="action",this.log[E](`[${p}] *<${this.getUsername()}>: ${T[1]}`),this.emits(["action","message"],[[p,$,T[1],!0]])):($["message-type"]="chat",this.log[E](`[${p}] <${this.getUsername()}>: ${l}`),this.emits(["chat","message"],[[p,$,l,!0]])),typeof g=="function"?g(h,c):h()})},_.prototype._updateEmoteset=function(a){let r=a!==void 0;if(r&&(a===this.emotes?r=!1:this.emotes=a),this._skipUpdatingEmotesets){r&&this.emit("emotesets",a,{});return}const l=()=>{this._updateEmotesetsTimerDelay>0&&(clearTimeout(this._updateEmotesetsTimer),this._updateEmotesetsTimer=setTimeout(()=>this._updateEmoteset(a),this._updateEmotesetsTimerDelay))};this._getToken().then(g=>{const h=`https://api.twitch.tv/kraken/chat/emoticon_images?emotesets=${a}`,c={};return"fetchAgent"in this.opts.connection&&(c.agent=this.opts.connection.fetchAgent),o(h,{...c,headers:{Accept:"application/vnd.twitchtv.v5+json",Authorization:`OAuth ${d.token(g)}`,"Client-ID":this.clientId}})}).then(g=>g.json()).then(g=>{this.emotesets=g.emoticon_sets||{},this.emit("emotesets",a,this.emotesets),l()}).catch(()=>l())},_.prototype.getUsername=function(){return this.username},_.prototype.getOptions=function(){return this.opts},_.prototype.getChannels=function(){return this.channels},_.prototype.isMod=function(a,r){const l=d.channel(a);return this.moderators[l]||(this.moderators[l]=[]),this.moderators[l].includes(d.username(r))},_.prototype.readyState=function(){return this.ws===null?"CLOSED":["CONNECTING","OPEN","CLOSING","CLOSED"][this.ws.readyState]},_.prototype._isConnected=function(){return this.ws!==null&&this.ws.readyState===1},_.prototype.disconnect=function(){return new Promise((a,r)=>{this.ws!==null&&this.ws.readyState!==3?(this.wasCloseCalled=!0,this.log.info("Disconnecting from server.."),this.ws.close(),this.once("_promiseDisconnect",()=>a([this.server,~~this.port]))):(this.log.error("Cannot disconnect from server. Socket is not opened or connection is already closing."),r("Cannot disconnect from server. Socket is not opened or connection is already closing."))})},_.prototype.off=_.prototype.removeListener,e.exports&&(e.exports=_),typeof window<"u"&&(window.tmi={client:_,Client:_})})(De);var xt=De.exports;const Me=xt;var Ct={client:Me,Client:Me};const kt=Ue(Ct);function Ie(e,t,s){return Math.min(Math.max(t,e),s)}function $e(e,t,s){return(t-e)*s+e}function St(){for(var e=0,t,s,o="";e<arguments.length;)(t=arguments[e++])&&(s=He(t))&&(o&&(o+=" "),o+=s);return o}function He(e){if(typeof e=="string")return e;for(var t,s="",o=0;o<e.length;o++)e[o]&&(t=He(e[o]))&&(s&&(s+=" "),s+=t);return s}var he="-";function Et(e){var t=Mt(e),s=e.conflictingClassGroups,o=e.conflictingClassGroupModifiers,n=o===void 0?{}:o;function i(m){var f=m.split(he);return f[0]===""&&f.length!==1&&f.shift(),We(f,t)||Tt(m)}function u(m,f){var w=s[m]||[];return f&&n[m]?[].concat(w,n[m]):w}return{getClassGroupId:i,getConflictingClassGroupIds:u}}function We(e,t){var u;if(e.length===0)return t.classGroupId;var s=e[0],o=t.nextPart.get(s),n=o?We(e.slice(1),o):void 0;if(n)return n;if(t.validators.length!==0){var i=e.join(he);return(u=t.validators.find(function(m){var f=m.validator;return f(i)}))==null?void 0:u.classGroupId}}var Re=/^\[(.+)\]$/;function Tt(e){if(Re.test(e)){var t=Re.exec(e)[1],s=t==null?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}}function Mt(e){var t=e.theme,s=e.prefix,o={nextPart:new Map,validators:[]},n=$t(Object.entries(e.classGroups),s);return n.forEach(function(i){var u=i[0],m=i[1];ue(m,o,u,t)}),o}function ue(e,t,s,o){e.forEach(function(n){if(typeof n=="string"){var i=n===""?t:Le(t,n);i.classGroupId=s;return}if(typeof n=="function"){if(It(n)){ue(n(o),t,s,o);return}t.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(function(u){var m=u[0],f=u[1];ue(f,Le(t,m),s,o)})})}function Le(e,t){var s=e;return t.split(he).forEach(function(o){s.nextPart.has(o)||s.nextPart.set(o,{nextPart:new Map,validators:[]}),s=s.nextPart.get(o)}),s}function It(e){return e.isThemeGetter}function $t(e,t){return t?e.map(function(s){var o=s[0],n=s[1],i=n.map(function(u){return typeof u=="string"?t+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(function(m){var f=m[0],w=m[1];return[t+f,w]})):u});return[o,i]}):e}function Rt(e){if(e<1)return{get:function(){},set:function(){}};var t=0,s=new Map,o=new Map;function n(i,u){s.set(i,u),t++,t>e&&(t=0,o=s,s=new Map)}return{get:function(u){var m=s.get(u);if(m!==void 0)return m;if((m=o.get(u))!==void 0)return n(u,m),m},set:function(u,m){s.has(u)?s.set(u,m):n(u,m)}}}var Je="!";function Lt(e){var t=e.separator||":",s=t.length===1,o=t[0],n=t.length;return function(u){for(var m=[],f=0,w=0,d,x=0;x<u.length;x++){var _=u[x];if(f===0){if(_===o&&(s||u.slice(x,x+n)===t)){m.push(u.slice(w,x)),w=x+n;continue}if(_==="/"){d=x;continue}}_==="["?f++:_==="]"&&f--}var b=m.length===0?u:u.substring(w),a=b.startsWith(Je),r=a?b.substring(1):b,l=d&&d>w?d-w:void 0;return{modifiers:m,hasImportantModifier:a,baseClassName:r,maybePostfixModifierPosition:l}}}function Nt(e){if(e.length<=1)return e;var t=[],s=[];return e.forEach(function(o){var n=o[0]==="[";n?(t.push.apply(t,s.sort().concat([o])),s=[]):s.push(o)}),t.push.apply(t,s.sort()),t}function At(e){return{cache:Rt(e.cacheSize),splitModifiers:Lt(e),...Et(e)}}var Ot=/\s+/;function jt(e,t){var s=t.splitModifiers,o=t.getClassGroupId,n=t.getConflictingClassGroupIds,i=new Set;return e.trim().split(Ot).map(function(u){var m=s(u),f=m.modifiers,w=m.hasImportantModifier,d=m.baseClassName,x=m.maybePostfixModifierPosition,_=o(x?d.substring(0,x):d),b=!!x;if(!_){if(!x)return{isTailwindClass:!1,originalClassName:u};if(_=o(d),!_)return{isTailwindClass:!1,originalClassName:u};b=!1}var a=Nt(f).join(":"),r=w?a+Je:a;return{isTailwindClass:!0,modifierId:r,classGroupId:_,originalClassName:u,hasPostfixModifier:b}}).reverse().filter(function(u){if(!u.isTailwindClass)return!0;var m=u.modifierId,f=u.classGroupId,w=u.hasPostfixModifier,d=m+f;return i.has(d)?!1:(i.add(d),n(f,w).forEach(function(x){return i.add(m+x)}),!0)}).reverse().map(function(u){return u.originalClassName}).join(" ")}function Pt(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var o,n,i,u=m;function m(w){var d=t[0],x=t.slice(1),_=x.reduce(function(b,a){return a(b)},d());return o=At(_),n=o.cache.get,i=o.cache.set,u=f,f(w)}function f(w){var d=n(w);if(d)return d;var x=jt(w,o);return i(w,x),x}return function(){return u(St.apply(null,arguments))}}function M(e){var t=function(o){return o[e]||[]};return t.isThemeGetter=!0,t}var Ve=/^\[(?:([a-z-]+):)?(.+)\]$/i,zt=/^\d+\/\d+$/,Ut=new Set(["px","full","screen"]),Dt=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Gt=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|^0$/,Bt=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function P(e){return G(e)||Ut.has(e)||zt.test(e)||D(e)}function D(e){return B(e,"length",qt)}function Ft(e){return B(e,"size",qe)}function Ht(e){return B(e,"position",qe)}function Wt(e){return B(e,"url",Qt)}function se(e){return B(e,"number",G)}function G(e){return!Number.isNaN(Number(e))}function Jt(e){return e.endsWith("%")&&G(e.slice(0,-1))}function q(e){return Ne(e)||B(e,"number",Ne)}function R(e){return Ve.test(e)}function Q(){return!0}function U(e){return Dt.test(e)}function Vt(e){return B(e,"",Zt)}function B(e,t,s){var o=Ve.exec(e);return o?o[1]?o[1]===t:s(o[2]):!1}function qt(e){return Gt.test(e)}function qe(){return!1}function Qt(e){return e.startsWith("url(")}function Ne(e){return Number.isInteger(Number(e))}function Zt(e){return Bt.test(e)}function Xt(){var e=M("colors"),t=M("spacing"),s=M("blur"),o=M("brightness"),n=M("borderColor"),i=M("borderRadius"),u=M("borderSpacing"),m=M("borderWidth"),f=M("contrast"),w=M("grayscale"),d=M("hueRotate"),x=M("invert"),_=M("gap"),b=M("gradientColorStops"),a=M("gradientColorStopPositions"),r=M("inset"),l=M("margin"),g=M("opacity"),h=M("padding"),c=M("saturate"),p=M("scale"),S=M("sepia"),$=M("skew"),E=M("space"),T=M("translate"),k=function(){return["auto","contain","none"]},v=function(){return["auto","hidden","clip","visible","scroll"]},I=function(){return["auto",t]},N=function(){return["",P]},j=function(){return["auto",G,R]},me=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},K=function(){return["solid","dashed","dotted","double","none"]},fe=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},ne=function(){return["start","end","center","between","around","evenly","stretch"]},J=function(){return["","0",R]},pe=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},V=function(){return[G,se]},ee=function(){return[G,R]};return{cacheSize:500,theme:{colors:[Q],spacing:[P],blur:["none","",U,D],brightness:V(),borderColor:[e],borderRadius:["none","","full",U,D],borderSpacing:[t],borderWidth:N(),contrast:V(),grayscale:J(),hueRotate:ee(),invert:J(),gap:[t],gradientColorStops:[e],gradientColorStopPositions:[Jt,D],inset:I(),margin:I(),opacity:V(),padding:[t],saturate:V(),scale:V(),sepia:J(),skew:ee(),space:[t],translate:[t]},classGroups:{aspect:[{aspect:["auto","square","video",R]}],container:["container"],columns:[{columns:[U]}],"break-after":[{"break-after":pe()}],"break-before":[{"break-before":pe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(me(),[R])}],overflow:[{overflow:v()}],"overflow-x":[{"overflow-x":v()}],"overflow-y":[{"overflow-y":v()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[r]}],"inset-x":[{"inset-x":[r]}],"inset-y":[{"inset-y":[r]}],start:[{start:[r]}],end:[{end:[r]}],top:[{top:[r]}],right:[{right:[r]}],bottom:[{bottom:[r]}],left:[{left:[r]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",q]}],basis:[{basis:I()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",R]}],grow:[{grow:J()}],shrink:[{shrink:J()}],order:[{order:["first","last","none",q]}],"grid-cols":[{"grid-cols":[Q]}],"col-start-end":[{col:["auto",{span:[q]},R]}],"col-start":[{"col-start":j()}],"col-end":[{"col-end":j()}],"grid-rows":[{"grid-rows":[Q]}],"row-start-end":[{row:["auto",{span:[q]},R]}],"row-start":[{"row-start":j()}],"row-end":[{"row-end":j()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",R]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",R]}],gap:[{gap:[_]}],"gap-x":[{"gap-x":[_]}],"gap-y":[{"gap-y":[_]}],"justify-content":[{justify:["normal"].concat(ne())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(ne(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(ne(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[h]}],px:[{px:[h]}],py:[{py:[h]}],ps:[{ps:[h]}],pe:[{pe:[h]}],pt:[{pt:[h]}],pr:[{pr:[h]}],pb:[{pb:[h]}],pl:[{pl:[h]}],m:[{m:[l]}],mx:[{mx:[l]}],my:[{my:[l]}],ms:[{ms:[l]}],me:[{me:[l]}],mt:[{mt:[l]}],mr:[{mr:[l]}],mb:[{mb:[l]}],ml:[{ml:[l]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",t]}],"min-w":[{"min-w":["min","max","fit",P]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[U]},U,D]}],h:[{h:[t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",P]}],"max-h":[{"max-h":[t,"min","max","fit"]}],"font-size":[{text:["base",U,D]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",se]}],"font-family":[{font:[Q]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",D]}],"line-clamp":[{"line-clamp":["none",G,se]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",P]}],"list-image":[{"list-image":["none",R]}],"list-style-type":[{list:["none","disc","decimal",R]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(K(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",P]}],"underline-offset":[{"underline-offset":["auto",P]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:[t]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",D]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",R]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(me(),[Ht])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Ft]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Wt]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[a]}],"gradient-via-pos":[{via:[a]}],"gradient-to-pos":[{to:[a]}],"gradient-from":[{from:[b]}],"gradient-via":[{via:[b]}],"gradient-to":[{to:[b]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[m]}],"border-w-x":[{"border-x":[m]}],"border-w-y":[{"border-y":[m]}],"border-w-s":[{"border-s":[m]}],"border-w-e":[{"border-e":[m]}],"border-w-t":[{"border-t":[m]}],"border-w-r":[{"border-r":[m]}],"border-w-b":[{"border-b":[m]}],"border-w-l":[{"border-l":[m]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[].concat(K(),["hidden"])}],"divide-x":[{"divide-x":[m]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[m]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:K()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:[""].concat(K())}],"outline-offset":[{"outline-offset":[P]}],"outline-w":[{outline:[P]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:N()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[P]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",U,Vt]}],"shadow-color":[{shadow:[Q]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":fe()}],"bg-blend":[{"bg-blend":fe()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[o]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",U,R]}],grayscale:[{grayscale:[w]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[x]}],saturate:[{saturate:[c]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[w]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[c]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[u]}],"border-spacing-x":[{"border-spacing-x":[u]}],"border-spacing-y":[{"border-spacing-y":[u]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",R]}],duration:[{duration:ee()}],ease:[{ease:["linear","in","out","in-out",R]}],delay:[{delay:ee()}],animate:[{animate:["none","spin","ping","pulse","bounce",R]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[p]}],"scale-x":[{"scale-x":[p]}],"scale-y":[{"scale-y":[p]}],rotate:[{rotate:[q,R]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[$]}],"skew-y":[{"skew-y":[$]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",R]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",R]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":[t]}],"scroll-mx":[{"scroll-mx":[t]}],"scroll-my":[{"scroll-my":[t]}],"scroll-ms":[{"scroll-ms":[t]}],"scroll-me":[{"scroll-me":[t]}],"scroll-mt":[{"scroll-mt":[t]}],"scroll-mr":[{"scroll-mr":[t]}],"scroll-mb":[{"scroll-mb":[t]}],"scroll-ml":[{"scroll-ml":[t]}],"scroll-p":[{"scroll-p":[t]}],"scroll-px":[{"scroll-px":[t]}],"scroll-py":[{"scroll-py":[t]}],"scroll-ps":[{"scroll-ps":[t]}],"scroll-pe":[{"scroll-pe":[t]}],"scroll-pt":[{"scroll-pt":[t]}],"scroll-pr":[{"scroll-pr":[t]}],"scroll-pb":[{"scroll-pb":[t]}],"scroll-pl":[{"scroll-pl":[t]}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",R]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[P,se]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var Qe=Pt(Xt);const Yt=e=>C.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 340.274 340.274",fill:"currentColor",...e,children:C.jsx("path",{d:`M293.629,127.806l-5.795-13.739c19.846-44.856,18.53-46.189,14.676-50.08l-25.353-24.77l-2.516-2.12h-2.937
				c-1.549,0-6.173,0-44.712,17.48l-14.184-5.719c-18.332-45.444-20.212-45.444-25.58-45.444h-35.765
				c-5.362,0-7.446-0.006-24.448,45.606l-14.123,5.734C86.848,43.757,71.574,38.19,67.452,38.19l-3.381,0.105L36.801,65.032
				c-4.138,3.891-5.582,5.263,15.402,49.425l-5.774,13.691C0,146.097,0,147.838,0,153.33v35.068c0,5.501,0,7.44,46.585,24.127
				l5.773,13.667c-19.843,44.832-18.51,46.178-14.655,50.032l25.353,24.8l2.522,2.168h2.951c1.525,0,6.092,0,44.685-17.516
				l14.159,5.758c18.335,45.438,20.218,45.427,25.598,45.427h35.771c5.47,0,7.41,0,24.463-45.589l14.195-5.74
				c26.014,11,41.253,16.585,45.349,16.585l3.404-0.096l27.479-26.901c3.909-3.945,5.278-5.309-15.589-49.288l5.734-13.702
				c46.496-17.967,46.496-19.853,46.496-25.221v-35.029C340.268,146.361,340.268,144.434,293.629,127.806z M170.128,228.474
				c-32.798,0-59.504-26.187-59.504-58.364c0-32.153,26.707-58.315,59.504-58.315c32.78,0,59.43,26.168,59.43,58.315
				C229.552,202.287,202.902,228.474,170.128,228.474z`})}),Kt=Yt,es=e=>C.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",...e,children:C.jsx("path",{d:"M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2ZM15.36 14.3C15.65 14.59 15.65 15.07 15.36 15.36C15.21 15.51 15.02 15.58 14.83 15.58C14.64 15.58 14.45 15.51 14.3 15.36L12 13.06L9.7 15.36C9.55 15.51 9.36 15.58 9.17 15.58C8.98 15.58 8.79 15.51 8.64 15.36C8.35 15.07 8.35 14.59 8.64 14.3L10.94 12L8.64 9.7C8.35 9.41 8.35 8.93 8.64 8.64C8.93 8.35 9.41 8.35 9.7 8.64L12 10.94L14.3 8.64C14.59 8.35 15.07 8.35 15.36 8.64C15.65 8.93 15.65 9.41 15.36 9.7L13.06 12L15.36 14.3Z"})}),ts=es,Ae=e=>{let t;const s=new Set,o=(f,w)=>{const d=typeof f=="function"?f(t):f;if(!Object.is(d,t)){const x=t;t=w??typeof d!="object"?d:Object.assign({},t,d),s.forEach(_=>_(t,x))}},n=()=>t,m={setState:o,getState:n,subscribe:f=>(s.add(f),()=>s.delete(f)),destroy:()=>{({BASE_URL:"/numerica-rothio-skin/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}};return t=e(o,n,m),m},ss=e=>e?Ae(e):Ae;var Ze={exports:{}},Xe={},Ye={exports:{}},Ke={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W=A;function os(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rs=typeof Object.is=="function"?Object.is:os,ns=W.useState,is=W.useEffect,as=W.useLayoutEffect,ls=W.useDebugValue;function cs(e,t){var s=t(),o=ns({inst:{value:s,getSnapshot:t}}),n=o[0].inst,i=o[1];return as(function(){n.value=s,n.getSnapshot=t,le(n)&&i({inst:n})},[e,s,t]),is(function(){return le(n)&&i({inst:n}),e(function(){le(n)&&i({inst:n})})},[e]),ls(s),s}function le(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!rs(e,s)}catch{return!0}}function us(e,t){return t()}var ds=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?us:cs;Ke.useSyncExternalStore=W.useSyncExternalStore!==void 0?W.useSyncExternalStore:ds;Ye.exports=Ke;var hs=Ye.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var re=A,ms=hs;function fs(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ps=typeof Object.is=="function"?Object.is:fs,gs=ms.useSyncExternalStore,bs=re.useRef,vs=re.useEffect,_s=re.useMemo,ws=re.useDebugValue;Xe.useSyncExternalStoreWithSelector=function(e,t,s,o,n){var i=bs(null);if(i.current===null){var u={hasValue:!1,value:null};i.current=u}else u=i.current;i=_s(function(){function f(b){if(!w){if(w=!0,d=b,b=o(b),n!==void 0&&u.hasValue){var a=u.value;if(n(a,b))return x=a}return x=b}if(a=x,ps(d,b))return a;var r=o(b);return n!==void 0&&n(a,r)?a:(d=b,x=r)}var w=!1,d,x,_=s===void 0?null:s;return[function(){return f(t())},_===null?void 0:function(){return f(_())}]},[t,s,o,n]);var m=gs(e,i[0],i[1]);return vs(function(){u.hasValue=!0,u.value=m},[m]),ws(m),m};Ze.exports=Xe;var ys=Ze.exports;const xs=Ue(ys),{useSyncExternalStoreWithSelector:Cs}=xs;function ks(e,t=e.getState,s){const o=Cs(e.subscribe,e.getState,e.getServerState||e.getState,t,s);return A.useDebugValue(o),o}const Oe=e=>{({BASE_URL:"/numerica-rothio-skin/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?ss(e):e,s=(o,n)=>ks(t,o,n);return Object.assign(s,t),s},et=e=>e?Oe(e):Oe;function Ss(e,t){let s;try{s=e()}catch{return}return{getItem:n=>{var i;const u=f=>f===null?null:JSON.parse(f,t==null?void 0:t.reviver),m=(i=s.getItem(n))!=null?i:null;return m instanceof Promise?m.then(u):u(m)},setItem:(n,i)=>s.setItem(n,JSON.stringify(i,t==null?void 0:t.replacer)),removeItem:n=>s.removeItem(n)}}const X=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(o){return X(o)(s)},catch(o){return this}}}catch(s){return{then(o){return this},catch(o){return X(o)(s)}}}},Es=(e,t)=>(s,o,n)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:l=>l,version:0,merge:(l,g)=>({...g,...l}),...t},u=!1;const m=new Set,f=new Set;let w;try{w=i.getStorage()}catch{}if(!w)return e((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...l)},o,n);const d=X(i.serialize),x=()=>{const l=i.partialize({...o()});let g;const h=d({state:l,version:i.version}).then(c=>w.setItem(i.name,c)).catch(c=>{g=c});if(g)throw g;return h},_=n.setState;n.setState=(l,g)=>{_(l,g),x()};const b=e((...l)=>{s(...l),x()},o,n);let a;const r=()=>{var l;if(!w)return;u=!1,m.forEach(h=>h(o()));const g=((l=i.onRehydrateStorage)==null?void 0:l.call(i,o()))||void 0;return X(w.getItem.bind(w))(i.name).then(h=>{if(h)return i.deserialize(h)}).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==i.version){if(i.migrate)return i.migrate(h.state,h.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return h.state}).then(h=>{var c;return a=i.merge(h,(c=o())!=null?c:b),s(a,!0),x()}).then(()=>{g==null||g(a,void 0),u=!0,f.forEach(h=>h(a))}).catch(h=>{g==null||g(void 0,h)})};return n.persist={setOptions:l=>{i={...i,...l},l.getStorage&&(w=l.getStorage())},clearStorage:()=>{w==null||w.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>r(),hasHydrated:()=>u,onHydrate:l=>(m.add(l),()=>{m.delete(l)}),onFinishHydration:l=>(f.add(l),()=>{f.delete(l)})},r(),a||b},Ts=(e,t)=>(s,o,n)=>{let i={storage:Ss(()=>localStorage),partialize:r=>r,version:0,merge:(r,l)=>({...l,...r}),...t},u=!1;const m=new Set,f=new Set;let w=i.storage;if(!w)return e((...r)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...r)},o,n);const d=()=>{const r=i.partialize({...o()});return w.setItem(i.name,{state:r,version:i.version})},x=n.setState;n.setState=(r,l)=>{x(r,l),d()};const _=e((...r)=>{s(...r),d()},o,n);let b;const a=()=>{var r,l;if(!w)return;u=!1,m.forEach(h=>{var c;return h((c=o())!=null?c:_)});const g=((l=i.onRehydrateStorage)==null?void 0:l.call(i,(r=o())!=null?r:_))||void 0;return X(w.getItem.bind(w))(i.name).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==i.version){if(i.migrate)return i.migrate(h.state,h.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return h.state}).then(h=>{var c;return b=i.merge(h,(c=o())!=null?c:_),s(b,!0),d()}).then(()=>{g==null||g(b,void 0),b=o(),u=!0,f.forEach(h=>h(b))}).catch(h=>{g==null||g(void 0,h)})};return n.persist={setOptions:r=>{i={...i,...r},r.storage&&(w=r.storage)},clearStorage:()=>{w==null||w.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>a(),hasHydrated:()=>u,onHydrate:r=>(m.add(r),()=>{m.delete(r)}),onFinishHydration:r=>(f.add(r),()=>{f.delete(r)})},i.skipHydration||a(),b||_},Ms=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?(({BASE_URL:"/numerica-rothio-skin/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Es(e,t)):Ts(e,t),tt=Ms,Is=et(tt(e=>({mute:!0,volume:1,setMute:t=>e({mute:t}),setVolume:t=>e({volume:t})}),{name:"numerica-config",version:1})),de=Is,$s=({variant:e="high",...t})=>C.jsx("svg",{fill:"currentColor",width:"1em",height:"1em",viewBox:"-1 0 19 19",...t,children:e==="mute"?C.jsx("path",{d:"M16.417 9.583A7.917 7.917 0 1 1 8.5 1.666a7.917 7.917 0 0 1 7.917 7.917zM7.84 6.05c0-.435-.252-.54-.56-.232L5.16 7.94H3.704a.794.794 0 0 0-.791.793v1.686a.794.794 0 0 0 .791.792h1.457l2.12 2.12c.308.308.56.204.56-.232zm3.84 3.524 1.49-1.49a.396.396 0 0 0-.56-.56l-1.49 1.49-1.49-1.49a.396.396 0 0 0-.56.56l1.49 1.49-1.49 1.49a.396.396 0 1 0 .56.56l1.49-1.49 1.49 1.49a.396.396 0 0 0 .56-.56z"}):e==="low"?C.jsx("path",{d:"M16.417 9.583A7.917 7.917 0 1 1 8.5 1.666a7.917 7.917 0 0 1 7.917 7.917zM7.84 6.06c0-.435-.252-.54-.56-.231l-2.12 2.12H3.705a.794.794 0 0 0-.792.792v1.686a.794.794 0 0 0 .792.792H5.16l2.12 2.12c.308.308.56.204.56-.231zm2.543 3.524a2.547 2.547 0 0 0-.75-1.813.396.396 0 1 0-.56.56 1.773 1.773 0 0 1 0 2.506.396.396 0 1 0 .56.56 2.546 2.546 0 0 0 .75-1.813z"}):e==="medium"?C.jsx("path",{d:"M16.417 9.583A7.917 7.917 0 1 1 8.5 1.666a7.917 7.917 0 0 1 7.917 7.917zM7.84 6.06c0-.435-.252-.54-.56-.231l-2.12 2.12H3.704a.794.794 0 0 0-.791.792v1.686a.794.794 0 0 0 .791.792h1.457l2.12 2.12c.308.308.56.204.56-.231zm1.792 5.337a2.564 2.564 0 0 0 0-3.626.396.396 0 1 0-.56.56 1.773 1.773 0 0 1 0 2.506.396.396 0 1 0 .56.56zm2.597-1.813a4.38 4.38 0 0 0-1.292-3.118.396.396 0 0 0-.56.56 3.618 3.618 0 0 1 0 5.116.396.396 0 1 0 .56.56 4.38 4.38 0 0 0 1.292-3.118z"}):e==="high"?C.jsx("path",{d:"M16.417 9.583A7.917 7.917 0 1 1 8.5 1.666a7.917 7.917 0 0 1 7.917 7.917zM7.84 6.06c0-.435-.252-.54-.56-.232l-2.12 2.12H3.704a.794.794 0 0 0-.791.792v1.687a.794.794 0 0 0 .791.792h1.457l2.12 2.12c.308.308.56.204.56-.232zm1.792 5.336a2.566 2.566 0 0 0 0-3.625.396.396 0 0 0-.56.56 1.775 1.775 0 0 1 0 2.506.396.396 0 1 0 .56.56zm1.305 1.305a4.41 4.41 0 0 0 0-6.235.396.396 0 0 0-.56.56 3.618 3.618 0 0 1 0 5.116.396.396 0 1 0 .56.56zm2.68-.764a6.25 6.25 0 0 0-1.375-6.776.396.396 0 1 0-.56.56 5.464 5.464 0 0 1 0 7.726.396.396 0 1 0 .56.56 6.216 6.216 0 0 0 1.374-2.07z"}):null}),Rs=$s;function Ls(){const{mute:e,volume:t,setMute:s,setVolume:o}=de();return C.jsx("div",{className:"flex flex-col",children:C.jsxs("fieldset",{children:[C.jsx("legend",{children:"Bubble Sounds"}),C.jsxs("div",{className:"flex flex-row items-center gap-2 py-1",children:[C.jsxs("label",{htmlFor:"mute",children:[C.jsx(Rs,{className:"text-4xl",variant:e||t===0?"mute":t<.25?"low":t<.75?"medium":"high"}),C.jsx("input",{className:"sr-only",id:"mute",type:"checkbox",checked:e,onChange:n=>s(n.target.checked)})]}),C.jsx("input",{className:"accent-primary",type:"range",min:0,max:1,step:.01,value:t,onChange:n=>o(parseFloat(n.target.value))}),C.jsxs("span",{className:"w-[5ch] text-end",children:[Math.round(t*100),"%"]})]})]})})}function Ns(){const[e,t]=A.useState(!1),s=()=>t(o=>!o);return C.jsxs(C.Fragment,{children:[C.jsx("button",{className:"absolute bottom-0 right-0 border-2 border-primary p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 text-4lg outline-none",onClick:s,children:C.jsx(Kt,{})}),C.jsxs("div",{className:Qe("fixed bottom-0 right-0 bg-primary-dark w-screen h-screen z-20 transition-transform duration-200 flex justify-center items-center font-black",e?"translate-y-0 pointer-events-auto":"translate-y-full pointer-events-none"),children:[C.jsx("button",{className:"absolute top-2 right-2 border-2 border-primary text-primary p-2 rounded-lg",onClick:s,children:C.jsx(ts,{})}),C.jsx(Ls,{})]})]})}var oe=(e=>(e.IDLE="IDLE",e.STARTED="STARTED",e.GAME_OVER="GAME_OVER",e))(oe||{});const As=et(tt(e=>({status:"IDLE",number:0,user:"",maxScore:0,maxScoreUser:"",registerNewNumber:(t,s)=>{e(o=>o.user===s?{}:t===o.number+1?t>o.maxScore?{status:"STARTED",number:o.number+1,user:s,maxScore:o.number+1,maxScoreUser:s}:{status:"STARTED",number:o.number+1,user:s}:{status:o.number===0?"IDLE":"GAME_OVER",number:0,user:s})},setMaxScore:(t,s)=>{e(()=>({maxScore:t,maxScoreUser:s}))}}),{name:"numerica",version:1})),Os=As,je=1e4,Pe=4,js=1e3,Ps=40,ze=Array.from({length:8},(e,t)=>new Audio(`/bubble-${t}.mp3`));function Us(){const{channel:e}=ot(),{status:t,number:s,user:o,maxScore:n,maxScoreUser:i,registerNewNumber:u,setMaxScore:m}=Os(),f=de(r=>r.mute),w=de(r=>r.volume),[d,x]=A.useState(null),_=A.useRef(null),b=A.useRef({duration:je,numberOfBubbles:Pe,mute:f,volume:w});A.useEffect(()=>{const r=new URL(window.location.href),l=new URLSearchParams(r.hash.substr(1)),g=l.get("maxScore"),h=l.get("maxScoreUser"),c=Number(g),p=isFinite(c),S=c%1===0,$=c>0;!g||!h||!p||!S||!$||c<n||m(c,h)},[]),A.useEffect(()=>{if(!e)return;const r=new kt.Client({channels:[e]});return r.connect().catch(console.error),x(r),()=>{r.disconnect().catch(console.error)}},[e]);const a=A.useCallback((r,l,g,h)=>{if(h)return;const c=l.displayName||l.username;if(!c)return;const p=Number(g),S=isFinite(p),$=p%1===0,E=p>0;!S||!$||!E||u(p,c)},[u]);return A.useEffect(()=>{if(d)return d.on("message",a),()=>{d.removeListener("message",a)}},[d,a]),A.useEffect(()=>{const r=Ie(0,s,50)/Ie(5,n,50);b.current={duration:Math.round($e(je,js,r)),numberOfBubbles:Math.round($e(Pe,Ps,r)),mute:f,volume:w}},[s,n,f,w]),A.useEffect(()=>{let r=null,l=0;const g=h=>{if(!_.current)return;const{duration:c,numberOfBubbles:p}=b.current;if(c/p<h-l){const E=Math.random()*Math.PI*2,T=Math.sin(E)*35+50,k=Math.cos(E)*35+50,v=document.createElement("div");v.classList.add("absolute"),v.classList.add("bg-white"),v.classList.add("rounded-full"),v.classList.add("top-1/2"),v.classList.add("left-1/2"),v.classList.add("-translate-y-1/2"),v.classList.add("-translate-x-1/2"),v.classList.add("animate-bubble"),v.style.setProperty("--target-top",`${T}%`),v.style.setProperty("--target-left",`${k}%`),v.style.setProperty("--animation-duration",`${c}ms`),_.current.appendChild(v),setTimeout(()=>{const{mute:I,volume:N}=b.current;if(!I&&N>0){const j=ze[Math.floor(Math.random()*ze.length)];j.volume=N,j.play()}},Math.floor(c*.67)),setTimeout(()=>{var I;(I=_.current)==null||I.removeChild(v)},c),l=h}r=requestAnimationFrame(g)};return r=requestAnimationFrame(g),()=>{r&&cancelAnimationFrame(r)}},[]),C.jsxs("div",{className:"relative group",children:[C.jsxs("div",{className:"overflow-hidden relative flex items-center justify-center w-[400px] h-[400px] rounded-full ",children:[[s-1,s].map(r=>r<0?null:C.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-[200px] h-[200px] flex justify-center items-center bg-black p-4 rounded-full overflow-hidden mix-blend-screen contrast-[100]",children:C.jsx("span",{className:Qe("text-8xl font-bold leading-tight text-white blur-[1px]",r===s?"animate-bubble-fade-in":"animate-bubble-fade-out opacity-0"),children:r})},r)),C.jsxs("div",{className:"absolute -inset-[100px]",children:[C.jsx("div",{className:"absolute inset-0 bg-primary"}),C.jsx("div",{className:"absolute inset-0 bg-black blur-lg contrast-[100] flex items-center justify-center mix-blend-multiply",ref:_,children:C.jsx("div",{className:"bg-white w-[200px] h-[200px] rounded-full"})})]})]}),C.jsxs("p",{className:"text-xl font-bold text-white bg-primary py-2 px-6 rounded-3xl absolute top-0 left-1/2 -translate-x-1/2 whitespace-nowrap text-center",children:["Max Score: ",n,i&&C.jsxs(C.Fragment,{children:[C.jsx("br",{}),"by ",i]})]}),(t===oe.GAME_OVER||t===oe.STARTED)&&C.jsx("p",{className:"text-xl font-bold text-white bg-primary py-2 px-6 rounded-3xl absolute bottom-0 left-1/2 -translate-x-1/2 whitespace-nowrap text-center",children:t===oe.GAME_OVER?`Blame on ${o}!`:o}),C.jsx(Ns,{})]})}export{Us as default};
